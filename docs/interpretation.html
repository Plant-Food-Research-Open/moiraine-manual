<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>The moiraine R package user manual - 12&nbsp; Interpreting the integration results</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./evaluation.html" rel="next">
<link href="./diablo.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Interpreting the integration results</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">The <code>moiraine</code> R package user manual</a> 
        <div class="sidebar-tools-main">
    <a href="" title="" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-github"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
<li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/Plant-Food-Research-Open/moiraine-manual">
          Manual source code
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/Plant-Food-Research-Open/moiraine">
          Package source code
          </a>
        </li>
    </ul>
<a href="https://twitter.com/intent/tweet?url=%7Curl%7C" title="Twitter" class="sidebar-tool px-1"><i class="bi bi-twitter"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./overview.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Overview of <code>moiraine</code></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example_dataset.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The example dataset</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Data preparation</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_import.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Importing data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inspecting_multidataset.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Inspecting the <code>MultiDataSet</code> object</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modifying_multidataset.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modifying the <code>MultiDataSet</code> object</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preprocessing.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data pre-processing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prefiltering.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Dataset pre-filtering</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Unsupervised integration</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spls.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Integration with sPLS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./so2pls.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Integration with sO2PLS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mofa.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Integration with MOFA</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Supervised integration</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./diablo.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Integration with DIABLO</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Results interpretation</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./interpretation.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Interpreting the integration results</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./evaluation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Evaluating the integration results</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./comparison.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Comparing the integration results</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#sec-interpretation-dim-reduction" id="toc-sec-interpretation-dim-reduction" class="nav-link active" data-scroll-target="#sec-interpretation-dim-reduction"><span class="toc-section-number">12.1</span>  Dimension reduction methods</a></li>
  <li>
<a href="#sec-interpretation-standard-output" id="toc-sec-interpretation-standard-output" class="nav-link" data-scroll-target="#sec-interpretation-standard-output"><span class="toc-section-number">12.2</span>  Generating a standardised output</a>
  <ul class="collapse">
<li><a href="#get_output-function" id="toc-get_output-function" class="nav-link" data-scroll-target="#get_output-function"><span class="toc-section-number">12.2.1</span>  <code>get_output</code> function</a></li>
  <li><a href="#averaging-latent-dimensions-over-datasets" id="toc-averaging-latent-dimensions-over-datasets" class="nav-link" data-scroll-target="#averaging-latent-dimensions-over-datasets"><span class="toc-section-number">12.2.2</span>  Averaging latent dimensions over datasets</a></li>
  </ul>
</li>
  <li><a href="#percentage-of-variance-explained" id="toc-percentage-of-variance-explained" class="nav-link" data-scroll-target="#percentage-of-variance-explained"><span class="toc-section-number">12.3</span>  Percentage of variance explained</a></li>
  <li>
<a href="#sec-interpretation-samples-scores" id="toc-sec-interpretation-samples-scores" class="nav-link" data-scroll-target="#sec-interpretation-samples-scores"><span class="toc-section-number">12.4</span>  Samples plot</a>
  <ul class="collapse">
<li><a href="#sec-interpretation-samples-ggpairs" id="toc-sec-interpretation-samples-ggpairs" class="nav-link" data-scroll-target="#sec-interpretation-samples-ggpairs"><span class="toc-section-number">12.4.1</span>  Matrix of scatter plots</a></li>
  <li><a href="#sec-interpretation-samples-pair" id="toc-sec-interpretation-samples-pair" class="nav-link" data-scroll-target="#sec-interpretation-samples-pair"><span class="toc-section-number">12.4.2</span>  Scatter plot for pair of latent dimensions</a></li>
  <li><a href="#sec-interpretation-samples-covariate" id="toc-sec-interpretation-samples-covariate" class="nav-link" data-scroll-target="#sec-interpretation-samples-covariate"><span class="toc-section-number">12.4.3</span>  Samples score vs covariate</a></li>
  </ul>
</li>
  <li>
<a href="#feature-plots" id="toc-feature-plots" class="nav-link" data-scroll-target="#feature-plots"><span class="toc-section-number">12.5</span>  Feature plots</a>
  <ul class="collapse">
<li><a href="#sec-interpretation-features-distr" id="toc-sec-interpretation-features-distr" class="nav-link" data-scroll-target="#sec-interpretation-features-distr"><span class="toc-section-number">12.5.1</span>  Features weight distribution</a></li>
  <li><a href="#sec-interpretation-features-pair" id="toc-sec-interpretation-features-pair" class="nav-link" data-scroll-target="#sec-interpretation-features-pair"><span class="toc-section-number">12.5.2</span>  Comparing features importance between latent components</a></li>
  <li><a href="#sec-interpretation-features-top-plot" id="toc-sec-interpretation-features-top-plot" class="nav-link" data-scroll-target="#sec-interpretation-features-top-plot"><span class="toc-section-number">12.5.3</span>  Plotting top features weight</a></li>
  <li><a href="#sec-interpretation-features-top-table" id="toc-sec-interpretation-features-top-table" class="nav-link" data-scroll-target="#sec-interpretation-features-top-table"><span class="toc-section-number">12.5.4</span>  Extracting top features</a></li>
  <li><a href="#sec-interpretation-features-selected" id="toc-sec-interpretation-features-selected" class="nav-link" data-scroll-target="#sec-interpretation-features-selected"><span class="toc-section-number">12.5.5</span>  Extracting the selected features</a></li>
  <li><a href="#sec-interpretation-features-meas" id="toc-sec-interpretation-features-meas" class="nav-link" data-scroll-target="#sec-interpretation-features-meas"><span class="toc-section-number">12.5.6</span>  Features measurements</a></li>
  </ul>
</li>
  <li><a href="#recap-targets-list" id="toc-recap-targets-list" class="nav-link" data-scroll-target="#recap-targets-list"><span class="toc-section-number">12.6</span>  Recap – targets list</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-interpretation" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Interpreting the integration results</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/targets/">targets</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/PlantandFoodResearch/moiraine">moiraine</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## For working with lists</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/">purrr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## For data-frames manipulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## For colour palettes</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/circlize">circlize</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## For manipulating patchworks of plots</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the previous chapters, we have applied different integration tools to our example multi-omics dataset. In each of these chapters, we have shown some method-specific visualisations that could be used to interpret the integration results. With the <code>moiraine</code> package, it is possible to use method-agnostic functions to inspect and interpret these results. These functionalities make use of the metadata in the <code>MultiDataSet</code> object to enrich plots and other summary outputs with information about the samples and the omics features, and allow users to obtain consistent visualisations across the integration methods used.</p>
<details><summary><code>_targets.R</code> script
</summary><div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/targets/">targets</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/tarchetypes/">tarchetypes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/PlantandFoodResearch/moiraine">moiraine</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_option_set.html">tar_option_set</a></span><span class="op">(</span></span>
<span>  packages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"moiraine"</span>,</span>
<span>    <span class="st">"MOFA2"</span>,</span>
<span>    <span class="st">"mixOmics"</span>,</span>
<span>    <span class="st">"readr"</span>,</span>
<span>    <span class="st">"tibble"</span>,</span>
<span>    <span class="st">"tidyr"</span>,</span>
<span>    <span class="st">"dplyr"</span>,</span>
<span>    <span class="st">"ggplot2"</span>,</span>
<span>    <span class="st">"patchwork"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span><span class="co"># Importing data ---------------------------------------------------------------</span></span>
<span></span>
<span>  <span class="co">## Data import using a target factory</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/import_dataset_csv_factory.html">import_dataset_csv_factory</a></span><span class="op">(</span></span>
<span>    files <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/genomics_dataset.csv"</span>, package <span class="op">=</span> <span class="st">"moiraine"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/transcriptomics_dataset.csv"</span>, package <span class="op">=</span> <span class="st">"moiraine"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/metabolomics_dataset.csv"</span>, package <span class="op">=</span> <span class="st">"moiraine"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    col_ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"marker"</span>, <span class="st">"gene_id"</span>, <span class="st">"sample_id"</span><span class="op">)</span>,</span>
<span>    features_as_rowss <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>    target_name_suffixes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"geno"</span>, <span class="st">"transcripto"</span>, <span class="st">"metabo"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Genomics features metadata file</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">fmetadata_file_geno</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/genomics_features_info.csv"</span>, package <span class="op">=</span> <span class="st">"moiraine"</span><span class="op">)</span>,</span>
<span>    format <span class="op">=</span> <span class="st">"file"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Genomics features metadata import</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">fmetadata_geno</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/import_fmetadata_csv.html">import_fmetadata_csv</a></span><span class="op">(</span></span>
<span>      <span class="va">fmetadata_file_geno</span>,</span>
<span>      col_id <span class="op">=</span> <span class="st">"marker"</span>,</span>
<span>      col_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"chromosome"</span> <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Metabolomics features metadata import</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/import_fmetadata_csv_factory.html">import_fmetadata_csv_factory</a></span><span class="op">(</span></span>
<span>    files <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/metabolomics_features_info.csv"</span>, package <span class="op">=</span> <span class="st">"moiraine"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    col_ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"feature_id"</span><span class="op">)</span>,</span>
<span>    target_name_suffixes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"metabo"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Transcriptomics features metadata import</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/import_fmetadata_gff_factory.html">import_fmetadata_gff_factory</a></span><span class="op">(</span></span>
<span>    files <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/bos_taurus_gene_model.gff3"</span>, package <span class="op">=</span> <span class="st">"moiraine"</span><span class="op">)</span>,</span>
<span>    feature_types <span class="op">=</span> <span class="st">"genes"</span>,</span>
<span>    add_fieldss <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Name"</span>, <span class="st">"description"</span><span class="op">)</span>,</span>
<span>    target_name_suffixes <span class="op">=</span> <span class="st">"transcripto"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Samples metadata import</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/import_smetadata_csv_factory.html">import_smetadata_csv_factory</a></span><span class="op">(</span></span>
<span>    files <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/samples_info.csv"</span>, package <span class="op">=</span> <span class="st">"moiraine"</span><span class="op">)</span>,</span>
<span>    col_ids <span class="op">=</span> <span class="st">"animal_id"</span>,</span>
<span>    target_name_suffixes <span class="op">=</span> <span class="st">"all"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Creating omics sets for each dataset</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/create_omics_set_factory.html">create_omics_set_factory</a></span><span class="op">(</span></span>
<span>    datasets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">data_geno</span>, <span class="va">data_transcripto</span>, <span class="va">data_metabo</span><span class="op">)</span>,</span>
<span>    omics_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"genomics"</span>, <span class="st">"transcriptomics"</span>, <span class="st">"metabolomics"</span><span class="op">)</span>,</span>
<span>    features_metadatas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">fmetadata_geno</span>, <span class="va">fmetadata_transcripto</span>, <span class="va">fmetadata_metabo</span><span class="op">)</span>,</span>
<span>    samples_metadatas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">smetadata_all</span>, <span class="va">smetadata_all</span>, <span class="va">smetadata_all</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Creating the MultiDataSet object</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">mo_set</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/create_multiomics_set.html">create_multiomics_set</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">set_geno</span>,</span>
<span>           <span class="va">set_transcripto</span>,</span>
<span>           <span class="va">set_metabo</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span></span>
<span><span class="co"># Inspecting the `MultiDataSet` object -----------------------------------------</span></span>
<span></span>
<span>  <span class="co">## Creating a density plot for each dataset</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">density_plots</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_density_data.html">plot_density_data</a></span><span class="op">(</span></span>
<span>      <span class="va">mo_set</span>,</span>
<span>      combined <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>      scales <span class="op">=</span> <span class="st">"free"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span></span>
<span>  <span class="co">## Plotting the relationship between features mean and standard deviation</span></span>
<span>  <span class="co">## for each dataset</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">mean_sd_plots</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_meansd_data.html">plot_meansd_data</a></span><span class="op">(</span><span class="va">mo_set</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Assessing missing values</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">n_missing_values</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/check_missing_values.html">check_missing_values</a></span><span class="op">(</span><span class="va">mo_set</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span></span>
<span><span class="co"># Modifying the `MultiDataSet` object ------------------------------------------</span></span>
<span></span>
<span>  <span class="co">## RNAseq differential expression results file</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">rnaseq_de_res_file</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span></span>
<span>      <span class="st">"extdata/transcriptomics_de_results.csv"</span>,</span>
<span>      package <span class="op">=</span> <span class="st">"moiraine"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    format <span class="op">=</span> <span class="st">"file"</span></span>
<span>  <span class="op">)</span>,</span>
<span></span>
<span>  <span class="co">## Reading the RNAseq differential expression results</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">rnaseq_de_res_df</span>,</span>
<span>    <span class="fu">read_csv</span><span class="op">(</span><span class="va">rnaseq_de_res_file</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>feature_id <span class="op">=</span> <span class="va">gene_id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"rnaseq"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span></span>
<span>  <span class="co">## Adding the differential expression results to the MultiDataSet object</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">mo_set_de</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/add_features_metadata.html">add_features_metadata</a></span><span class="op">(</span><span class="va">mo_set</span>, <span class="va">rnaseq_de_res_df</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span></span>
<span><span class="co"># Data pre-processing ----------------------------------------------------------</span></span>
<span></span>
<span>  <span class="co">## Applying transformations to the datasets</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/transformation_datasets_factory.html">transformation_datasets_factory</a></span><span class="op">(</span></span>
<span>    <span class="va">mo_set_de</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"rnaseq"</span> <span class="op">=</span> <span class="st">"vst-deseq2"</span>,</span>
<span>      <span class="st">"metabolome"</span> <span class="op">=</span> <span class="st">"logx"</span><span class="op">)</span>,</span>
<span>    log_bases <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    pre_log_functions <span class="op">=</span> <span class="va">zero_to_half_min</span>,</span>
<span>    transformed_data_name <span class="op">=</span> <span class="st">"mo_set_transformed"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Density plot for each transformed dataset</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">density_plots_transformed</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_density_data.html">plot_density_data</a></span><span class="op">(</span></span>
<span>      <span class="va">mo_set_transformed</span>,</span>
<span>      combined <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>      scales <span class="op">=</span> <span class="st">"free"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Plotting the mean-SD trend for transformed each dataset</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">mean_sd_plots_transformed</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_meansd_data.html">plot_meansd_data</a></span><span class="op">(</span><span class="va">mo_set_transformed</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Summary table of the transformations applied</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">transformation_summary</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_table_transformations.html">get_table_transformations</a></span><span class="op">(</span><span class="va">transformations_runs_list</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Running a PCA on each dataset</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/pca_complete_data_factory.html">pca_complete_data_factory</a></span><span class="op">(</span></span>
<span>    <span class="va">mo_set_transformed</span>,</span>
<span>    complete_data_name <span class="op">=</span> <span class="st">"mo_set_complete"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## PCA screeplots</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">pca_screeplots</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_screeplot_pca.html">plot_screeplot_pca</a></span><span class="op">(</span><span class="va">pca_runs_list</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## PCA sample plots</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">pca_sample_plots</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_samples_coordinates_pca.html">plot_samples_coordinates_pca</a></span><span class="op">(</span></span>
<span>      <span class="va">pca_runs_list</span>,</span>
<span>      datasets <span class="op">=</span> <span class="st">"snps"</span>,</span>
<span>      pcs <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>      mo_data <span class="op">=</span> <span class="va">mo_set_de</span>,</span>
<span>      colour_upper <span class="op">=</span> <span class="st">"geno_comp_cluster"</span>,</span>
<span>      shape_upper <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>      colour_lower <span class="op">=</span> <span class="st">"feedlot"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span></span>
<span><span class="co"># Dataset pre-filtering --------------------------------------------------------</span></span>
<span></span>
<span>  <span class="co">## Unsupervised feature selection based on MAD score</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/feature_preselection_mad_factory.html">feature_preselection_mad_factory</a></span><span class="op">(</span></span>
<span>    <span class="va">mo_set_complete</span>,</span>
<span>    to_keep_ns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"snps"</span> <span class="op">=</span> <span class="fl">1000</span>, <span class="st">"rnaseq"</span> <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>,</span>
<span>    with_ties <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    filtered_set_target_name <span class="op">=</span> <span class="st">"mo_presel_unsupervised"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Diagnostic plot for MAD-based feature selection</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">preselection_mad_plot</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_feature_preselection_mad.html">plot_feature_preselection_mad</a></span><span class="op">(</span><span class="va">individual_mad_values</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Supervised feature selection based on bruising groups</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/feature_preselection_splsda_factory.html">feature_preselection_splsda_factory</a></span><span class="op">(</span></span>
<span>    <span class="va">mo_set_complete</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>    to_keep_ns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"snps"</span> <span class="op">=</span> <span class="fl">1000</span>, <span class="st">"rnaseq"</span> <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>,</span>
<span>    filtered_set_target_name <span class="op">=</span> <span class="st">"mo_presel_supervised"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Diagnostic plot for sPLS-DA based feature selection</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">preselection_splsda_plot</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_feature_preselection_splsda.html">plot_feature_preselection_splsda</a></span><span class="op">(</span><span class="va">individual_splsda_perf</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span></span>
<span><span class="co"># Integration with sPLS --------------------------------------------------------</span></span>
<span></span>
<span>  <span class="co">## Creating sPLS input</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">spls_input</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_input_spls.html">get_input_spls</a></span><span class="op">(</span></span>
<span>      <span class="va">mo_presel_supervised</span>,</span>
<span>      mode <span class="op">=</span> <span class="st">"canonical"</span>,</span>
<span>      datasets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"rnaseq"</span>, <span class="st">"metabolome"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Initial PLS run with no feature selection and large number of components</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">spls_novarsel</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/spls_run.html">spls_run</a></span><span class="op">(</span></span>
<span>      <span class="va">spls_input</span>,</span>
<span>      ncomp <span class="op">=</span> <span class="fl">4</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Cross-validation for number of components</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">spls_perf_res</span>,</span>
<span>    <span class="fu">mixOmics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mixOmics/man/perf.html">perf</a></span><span class="op">(</span></span>
<span>      <span class="va">spls_novarsel</span>,</span>
<span>      validation <span class="op">=</span> <span class="st">"Mfold"</span>,</span>
<span>      folds <span class="op">=</span> <span class="fl">10</span>,</span>
<span>      nrepeat <span class="op">=</span> <span class="fl">10</span>,</span>
<span>      cpus <span class="op">=</span> <span class="fl">3</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Plotting cross-validation results (for number of components)</span></span>
<span>  <span class="co">## Can try criterion = 'Q2.total', 'cor.tpred', 'cor.upred', 'RSS.tpred',</span></span>
<span>  <span class="co">## 'RSS.upred' (but avoid 'RSS' and 'PRESS')</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">spls_perf_plot</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">spls_perf_res</span>, criterion <span class="op">=</span> <span class="st">"Q2.total"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Selected value for ncomp</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">spls_optim_ncomp</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/spls_get_optim_ncomp.html">spls_get_optim_ncomp</a></span><span class="op">(</span><span class="va">spls_perf_res</span>, min_ncomp <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Cross-validation for number of features to retain</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">spls_tune_res</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/spls_tune.html">spls_tune</a></span><span class="op">(</span></span>
<span>      <span class="va">spls_input</span>,</span>
<span>      ncomp <span class="op">=</span> <span class="va">spls_optim_ncomp</span>,</span>
<span>      keepX <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>      keepY <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>      validation <span class="op">=</span> <span class="st">"Mfold"</span>,</span>
<span>      folds <span class="op">=</span> <span class="fl">10</span>,</span>
<span>      nrepeat <span class="op">=</span> <span class="fl">5</span>,</span>
<span>      measure <span class="op">=</span> <span class="st">"cor"</span>,</span>
<span>      cpus <span class="op">=</span> <span class="fl">3</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Plotting cross-validation results (for number of features)</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">spls_tune_plot</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/spls_plot_tune.html">spls_plot_tune</a></span><span class="op">(</span><span class="va">spls_tune_res</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Final sPLS run</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">spls_final_run</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/spls_run.html">spls_run</a></span><span class="op">(</span></span>
<span>      <span class="va">spls_input</span>,</span>
<span>      ncomp <span class="op">=</span> <span class="va">spls_optim_ncomp</span>,</span>
<span>      keepX <span class="op">=</span> <span class="va">spls_tune_res</span><span class="op">$</span><span class="va">choice.keepX</span>,</span>
<span>      keepY <span class="op">=</span> <span class="va">spls_tune_res</span><span class="op">$</span><span class="va">choice.keepY</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span></span>
<span><span class="co"># Integration with sO2PLS ------------------------------------------------------</span></span>
<span></span>
<span>  <span class="co">## Creating sO2PLS input</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">omicspls_input</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_input_omicspls.html">get_input_omicspls</a></span><span class="op">(</span></span>
<span>      <span class="va">mo_presel_supervised</span>,</span>
<span>      datasets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"rnaseq"</span>, <span class="st">"metabolome"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Adjusted cross-validation for number of components</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">so2pls_cv_adj</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/so2pls_crossval_o2m_adjR2.html">so2pls_crossval_o2m_adjR2</a></span><span class="op">(</span></span>
<span>      <span class="va">omicspls_input</span>,</span>
<span>      a <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,</span>
<span>      ax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>      ay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>      nr_folds <span class="op">=</span> <span class="fl">10</span>,</span>
<span>      nr_cores <span class="op">=</span> <span class="fl">6</span>,</span>
<span>      seed <span class="op">=</span> <span class="fl">127</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">so2pls_cv_adj_res</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/so2pls_get_optim_ncomp_adj.html">so2pls_get_optim_ncomp_adj</a></span><span class="op">(</span><span class="va">so2pls_cv_adj</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Plotting adjusted cross-validation results</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">so2pls_cv_adj_plot</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/so2pls_plot_cv_adj.html">so2pls_plot_cv_adj</a></span><span class="op">(</span><span class="va">so2pls_cv_adj</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Standard cross-validation for number of components</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">so2pls_cv</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/so2pls_crossval_o2m.html">so2pls_crossval_o2m</a></span><span class="op">(</span></span>
<span>      <span class="va">omicspls_input</span>,</span>
<span>      <span class="va">so2pls_cv_adj</span>,</span>
<span>      nr_folds <span class="op">=</span> <span class="fl">10</span>,</span>
<span>      nr_cores <span class="op">=</span> <span class="fl">6</span>,</span>
<span>      seed <span class="op">=</span> <span class="fl">356</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">so2pls_cv_res</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/so2pls_get_optim_ncomp.html">so2pls_get_optim_ncomp</a></span><span class="op">(</span><span class="va">so2pls_cv</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Plotting standard cross-validation results</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">so2pls_cv_plot</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/so2pls_plot_cv.html">so2pls_plot_cv</a></span><span class="op">(</span><span class="va">so2pls_cv</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Cross-validation for sparsity parameters</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">so2pls_cv_sparsity</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/so2pls_crossval_sparsity.html">so2pls_crossval_sparsity</a></span><span class="op">(</span></span>
<span>      <span class="va">omicspls_input</span>,</span>
<span>      n <span class="op">=</span> <span class="va">so2pls_cv_res</span><span class="op">[</span><span class="st">"n"</span><span class="op">]</span>,</span>
<span>      nx <span class="op">=</span> <span class="va">so2pls_cv_res</span><span class="op">[</span><span class="st">"nx"</span><span class="op">]</span>,</span>
<span>      ny <span class="op">=</span> <span class="va">so2pls_cv_res</span><span class="op">[</span><span class="st">"ny"</span><span class="op">]</span>,</span>
<span>      nr_folds <span class="op">=</span> <span class="fl">10</span>,</span>
<span>      keepx_seq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">30</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      keepy_seq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">40</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">so2pls_cv_sparsity_res</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/so2pls_get_optim_keep.html">so2pls_get_optim_keep</a></span><span class="op">(</span><span class="va">so2pls_cv_sparsity</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Plotting the results of the cross-validation for the number of features</span></span>
<span>  <span class="co">## to retain from each dataset for the different joint components</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">so2pls_cv_sparsity_plot</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/so2pls_plot_cv_sparsity.html">so2pls_plot_cv_sparsity</a></span><span class="op">(</span><span class="va">so2pls_cv_sparsity</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Extracting sparsity results in table format</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">so2pls_cv_sparsity_table</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/so2pls_print_cv_sparsity.html">so2pls_print_cv_sparsity</a></span><span class="op">(</span><span class="va">so2pls_cv_sparsity_res</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Final sO2PLS run</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">so2pls_final_run</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/so2pls_o2m.html">so2pls_o2m</a></span><span class="op">(</span></span>
<span>      <span class="va">omicspls_input</span>,</span>
<span>      <span class="va">so2pls_cv_res</span>,</span>
<span>      <span class="va">so2pls_cv_sparsity_res</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Summary plot of percentage of variance explained</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">so2pls_summary_plot</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/so2pls_plot_summary.html">so2pls_plot_summary</a></span><span class="op">(</span><span class="va">so2pls_final_run</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Screeplot</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">so2pls_screeplot</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/so2pls_screeplot.html">so2pls_screeplot</a></span><span class="op">(</span><span class="va">so2pls_final_run</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Comparison of samples score for joint components</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">so2pls_joint_components_comparison_plot</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/so2pls_compare_samples_joint_components.html">so2pls_compare_samples_joint_components</a></span><span class="op">(</span></span>
<span>      <span class="va">so2pls_final_run</span>,</span>
<span>      mo_data <span class="op">=</span> <span class="va">mo_set_de</span>,</span>
<span>      colour_by <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>      shape_by <span class="op">=</span> <span class="st">"feedlot"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Coefficient plot for joint components</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">so2pls_joint_components_coefficients_plot</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/so2pls_plot_joint_components_coefficients.html">so2pls_plot_joint_components_coefficients</a></span><span class="op">(</span><span class="va">so2pls_final_run</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Joint component samples score plot</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">so2pls_joint_components_samples_score_plot</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/so2pls_plot_samples_joint_components.html">so2pls_plot_samples_joint_components</a></span><span class="op">(</span></span>
<span>      <span class="va">so2pls_final_run</span>,</span>
<span>      mo_data <span class="op">=</span> <span class="va">mo_set_de</span>,</span>
<span>      colour_upper <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>      scale_colour_upper <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_colour_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Paired"</span><span class="op">)</span>,</span>
<span>      shape_upper <span class="op">=</span> <span class="st">"feedlot"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.box <span class="op">=</span> <span class="st">"vertical"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Specific components samples score plot</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">so2pls_specific_components_samples_score_plot</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/so2pls_plot_samples_specific_components.html">so2pls_plot_samples_specific_components</a></span><span class="op">(</span></span>
<span>      <span class="va">so2pls_final_run</span>,</span>
<span>      mo_data <span class="op">=</span> <span class="va">mo_set_de</span>,</span>
<span>      colour_upper <span class="op">=</span> <span class="st">"feedlot"</span>,</span>
<span>      scale_colour_upper <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_colour_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Paired"</span><span class="op">)</span>,</span>
<span>      colour_lower <span class="op">=</span> <span class="st">"rnaseq_batch"</span>,</span>
<span>      shape_upper <span class="op">=</span> <span class="st">"gender"</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.box <span class="op">=</span> <span class="st">"vertical"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span></span>
<span><span class="co"># Integration with MOFA --------------------------------------------------------</span></span>
<span></span>
<span>  <span class="co">## Creating MOFA input</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">mofa_input</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_input_mofa.html">get_input_mofa</a></span><span class="op">(</span></span>
<span>      <span class="va">mo_presel_supervised</span>,</span>
<span>      options_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>        data_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>scale_views <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>        model_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>likelihoods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>          <span class="st">"snps"</span> <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>          <span class="st">"rnaseq"</span> <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>          <span class="st">"metabolome"</span> <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        training_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">43</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      only_common_samples <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Overview plot of the samples in each dataset</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">mofa_input_plot</span>,</span>
<span>    <span class="fu">plot_data_overview</span><span class="op">(</span><span class="va">mofa_input</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Training MOFA model</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">mofa_trained</span>,</span>
<span>    <span class="fu">run_mofa</span><span class="op">(</span></span>
<span>      <span class="va">mofa_input</span>,</span>
<span>      save_data <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      use_basilisk <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Formatting MOFA output</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">mofa_output</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_output.html">get_output</a></span><span class="op">(</span><span class="va">mofa_trained</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Plots of variance explained</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">mofa_var_explained_plot</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_variance_explained.html">plot_variance_explained</a></span><span class="op">(</span></span>
<span>      <span class="va">mofa_trained</span>,</span>
<span>      x <span class="op">=</span> <span class="st">"view"</span>,  <span class="co">## datasets on the x-axis</span></span>
<span>      y <span class="op">=</span> <span class="st">"factor"</span> <span class="co">## factors on the y-axis</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">mofa_total_var_explained_plot</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_variance_explained.html">plot_variance_explained</a></span><span class="op">(</span></span>
<span>      <span class="va">mofa_trained</span>,</span>
<span>      x <span class="op">=</span> <span class="st">"view"</span>,</span>
<span>      y <span class="op">=</span> <span class="st">"factor"</span>,</span>
<span>      plot_total <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Plot of factors correlation with covariates</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">mofa_factors_covariates_cor_plot</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/mofa_plot_cor_covariates.html">mofa_plot_cor_covariates</a></span><span class="op">(</span><span class="va">mofa_trained</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span></span>
<span><span class="co"># Integration with DIABLO ------------------------------------------------------</span></span>
<span></span>
<span>  <span class="co">## Creating the DIABLO input</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">diablo_input</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_input_mixomics_supervised.html">get_input_mixomics_supervised</a></span><span class="op">(</span></span>
<span>      <span class="va">mo_presel_supervised</span>,</span>
<span>      group <span class="op">=</span> <span class="st">"status"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Running sPLS on each dataset to construct the design matrix</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/diablo_pairwise_pls_factory.html">diablo_pairwise_pls_factory</a></span><span class="op">(</span><span class="va">diablo_input</span><span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Initial DIABLO run with no feature selection and large number of components</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">diablo_novarsel</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/diablo_run.html">diablo_run</a></span><span class="op">(</span></span>
<span>      <span class="va">diablo_input</span>,</span>
<span>      <span class="va">diablo_design_matrix</span>,</span>
<span>      ncomp <span class="op">=</span> <span class="fl">7</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Cross-validation for number of components</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">diablo_perf_res</span>,</span>
<span>    <span class="fu">mixOmics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mixOmics/man/perf.html">perf</a></span><span class="op">(</span></span>
<span>      <span class="va">diablo_novarsel</span>,</span>
<span>      validation <span class="op">=</span> <span class="st">"Mfold"</span>,</span>
<span>      folds <span class="op">=</span> <span class="fl">10</span>,</span>
<span>      nrepeat <span class="op">=</span> <span class="fl">10</span>,</span>
<span>      cpus <span class="op">=</span> <span class="fl">3</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Plotting cross-validation results (for number of components)</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">diablo_perf_plot</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/diablo_plot_perf.html">diablo_plot_perf</a></span><span class="op">(</span><span class="va">diablo_perf_res</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Selected value for ncomp</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">diablo_optim_ncomp</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/diablo_get_optim_ncomp.html">diablo_get_optim_ncomp</a></span><span class="op">(</span><span class="va">diablo_perf_res</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Cross-validation for number of features to retain</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">diablo_tune_res</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/diablo_tune.html">diablo_tune</a></span><span class="op">(</span></span>
<span>      <span class="va">diablo_input</span>,</span>
<span>      <span class="va">diablo_design_matrix</span>,</span>
<span>      ncomp <span class="op">=</span> <span class="va">diablo_optim_ncomp</span>,</span>
<span>      validation <span class="op">=</span> <span class="st">"Mfold"</span>,</span>
<span>      folds <span class="op">=</span> <span class="fl">10</span>,</span>
<span>      nrepeat <span class="op">=</span> <span class="fl">5</span>,</span>
<span>      dist <span class="op">=</span> <span class="st">"centroids.dist"</span>,</span>
<span>      cpus <span class="op">=</span> <span class="fl">3</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Plotting cross-validation results (for number of features)</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">diablo_tune_plot</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/diablo_plot_tune.html">diablo_plot_tune</a></span><span class="op">(</span><span class="va">diablo_tune_res</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Final DIABLO run</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">diablo_final_run</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/diablo_run.html">diablo_run</a></span><span class="op">(</span></span>
<span>      <span class="va">diablo_input</span>,</span>
<span>      <span class="va">diablo_design_matrix</span>,</span>
<span>      ncomp <span class="op">=</span> <span class="va">diablo_optim_ncomp</span>,</span>
<span>      keepX <span class="op">=</span> <span class="va">diablo_tune_res</span><span class="op">$</span><span class="va">choice.keepX</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details><section id="sec-interpretation-dim-reduction" class="level2" data-number="12.1"><h2 data-number="12.1" class="anchored" data-anchor-id="sec-interpretation-dim-reduction">
<span class="header-section-number">12.1</span> Dimension reduction methods</h2>
<p>Despite relying on very different statistical approaches, the different integration methods included in the pipeline all perform dimension reduction of the omics datasets through feature extraction. That is, they construct a small number of latent components/variables/dimensions (that we refer to as <strong>latent dimensions</strong> in the <code>moiraine</code> package) that capture as much information from the original datasets as possible. A dimension reduction approach typically returns, for each latent dimension constructed, two sets of values:</p>
<ul>
<li><p><strong>Features weight</strong>: the contribution of the features from the different omics datasets to the latent dimension. All methods included in the pipeline construct latent dimensions as linear combinations of the original features, and therefore the features contribution is quantified by their weight in the linear combination for the corresponding latent dimension.</p></li>
<li><p><strong>Samples score</strong>: the projection of the samples onto the latent dimension.</p></li>
</ul>
<p>In addition, the fraction or percentage of variance that each latent dimension explains in the different omics datasets is usually calculated.</p>
<p>Interpreting the results of a dimension reduction method involves:</p>
<ul>
<li><p>Understanding the source of the variation captured by each latent dimension: is a given latent dimension representing an important source of biological variation, such as effect of a treatment, or age of the samples? Or do they show a source of technical variation, for example highlighting a group of outlier samples with different omics profiles from the rest of the observations? Answering these questions allows us to identify which latent dimensions capture the biological phenomenon investigated, or whether there are some sources of noise that should be accounted for in follow-up experiments.</p></li>
<li><p>Investigating which omics features are driving the latent dimensions: once we have identified some latent dimensions of interest, we can look at the features that contribute the most to these dimensions, in order to understand the molecular mechanisms or pathways involved. This is typically done after looking into the phenomenon captured by the latent dimensions, but can also help to identify it.</p></li>
</ul></section><section id="sec-interpretation-standard-output" class="level2" data-number="12.2"><h2 data-number="12.2" class="anchored" data-anchor-id="sec-interpretation-standard-output">
<span class="header-section-number">12.2</span> Generating a standardised output</h2>
<section id="get_output-function" class="level3" data-number="12.2.1"><h3 data-number="12.2.1" class="anchored" data-anchor-id="get_output-function">
<span class="header-section-number">12.2.1</span> <code>get_output</code> function</h3>
<p>In the <code>moiraine</code> package, the output of the different integration methods can be converted to a standardised output containing the pieces of information (features weight, samples score and percentage of variance explained) characteristic of dimension reduction methods, stored in a consistent format. This enables us to use functions for visualisation or analysis that can be applied to the results of any integration method, rather than having to implement one for each object type returned by the different integration packages.</p>
<p>The <code><a href="https://rdrr.io/pkg/moiraine/man/get_output.html">get_output()</a></code> function transforms the output from any integration package included in <code>moiraine</code> into an <code>output_dimension_reduction</code> object, which is a list with three tibbles: <code>features_weight</code>, <code>samples_score</code> and <code>variance_explained</code>:</p>
<div class="panel-tabset" data-group="method">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">sPLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">sO2PLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">MOFA</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">DIABLO</a></li>
</ul>
<div class="tab-content" data-group="method">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="targets-chunk">
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>  <span class="va">spls_output</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_output.html">get_output</a></span><span class="op">(</span><span class="va">spls_final_run</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_load.html">tar_load</a></span><span class="op">(</span><span class="va">spls_output</span><span class="op">)</span></span>
<span><span class="va">spls_output</span></span>
<span><span class="co">#&gt; $features_weight</span></span>
<span><span class="co">#&gt; # A tibble: 2,098 × 5</span></span>
<span><span class="co">#&gt;    feature_id         dataset latent_dimension weight importance</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;              &lt;fct&gt;   &lt;fct&gt;             &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 ENSBTAG00000000020 rnaseq  Component 1           0          0</span></span>
<span><span class="co">#&gt;  2 ENSBTAG00000000046 rnaseq  Component 1           0          0</span></span>
<span><span class="co">#&gt;  3 ENSBTAG00000000056 rnaseq  Component 1           0          0</span></span>
<span><span class="co">#&gt;  4 ENSBTAG00000000061 rnaseq  Component 1           0          0</span></span>
<span><span class="co">#&gt;  5 ENSBTAG00000000113 rnaseq  Component 1           0          0</span></span>
<span><span class="co">#&gt;  6 ENSBTAG00000000149 rnaseq  Component 1           0          0</span></span>
<span><span class="co">#&gt;  7 ENSBTAG00000000164 rnaseq  Component 1           0          0</span></span>
<span><span class="co">#&gt;  8 ENSBTAG00000000205 rnaseq  Component 1           0          0</span></span>
<span><span class="co">#&gt;  9 ENSBTAG00000000212 rnaseq  Component 1           0          0</span></span>
<span><span class="co">#&gt; 10 ENSBTAG00000000289 rnaseq  Component 1           0          0</span></span>
<span><span class="co">#&gt; # ℹ 2,088 more rows</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $samples_score</span></span>
<span><span class="co">#&gt; # A tibble: 278 × 3</span></span>
<span><span class="co">#&gt;    sample_id latent_dimension score</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;     &lt;fct&gt;            &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 G1979     Component 1      -3.63</span></span>
<span><span class="co">#&gt;  2 G2500     Component 1      -2.46</span></span>
<span><span class="co">#&gt;  3 G3030     Component 1      -6.42</span></span>
<span><span class="co">#&gt;  4 G3068     Component 1      -6.16</span></span>
<span><span class="co">#&gt;  5 G3121     Component 1      -3.39</span></span>
<span><span class="co">#&gt;  6 G3315     Component 1       4.98</span></span>
<span><span class="co">#&gt;  7 G3473     Component 1       5.29</span></span>
<span><span class="co">#&gt;  8 G3474     Component 1       4.97</span></span>
<span><span class="co">#&gt;  9 G3550     Component 1      -4.17</span></span>
<span><span class="co">#&gt; 10 G3594     Component 1       4.71</span></span>
<span><span class="co">#&gt; # ℹ 268 more rows</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $variance_explained</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 3</span></span>
<span><span class="co">#&gt;   latent_dimension dataset    prop_var_expl</span></span>
<span><span class="co">#&gt;   &lt;fct&gt;            &lt;fct&gt;              &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Component 1      rnaseq             0.205</span></span>
<span><span class="co">#&gt; 2 Component 1      metabolome         0.179</span></span>
<span><span class="co">#&gt; 3 Component 2      rnaseq             0.147</span></span>
<span><span class="co">#&gt; 4 Component 2      metabolome         0.108</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "output_dimension_reduction"</span></span>
<span><span class="co">#&gt; attr(,"method")</span></span>
<span><span class="co">#&gt; [1] "sPLS"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="targets-chunk">
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>  <span class="va">so2pls_output</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_output.html">get_output</a></span><span class="op">(</span><span class="va">so2pls_final_run</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_load.html">tar_load</a></span><span class="op">(</span><span class="va">so2pls_output</span><span class="op">)</span></span>
<span><span class="va">so2pls_output</span></span>
<span><span class="co">#&gt; $features_weight</span></span>
<span><span class="co">#&gt; # A tibble: 2,318 × 5</span></span>
<span><span class="co">#&gt;    feature_id         dataset latent_dimension  weight importance</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;              &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 ENSBTAG00000000020 rnaseq  joint component 1      0          0</span></span>
<span><span class="co">#&gt;  2 ENSBTAG00000000046 rnaseq  joint component 1      0          0</span></span>
<span><span class="co">#&gt;  3 ENSBTAG00000000056 rnaseq  joint component 1      0          0</span></span>
<span><span class="co">#&gt;  4 ENSBTAG00000000061 rnaseq  joint component 1      0          0</span></span>
<span><span class="co">#&gt;  5 ENSBTAG00000000113 rnaseq  joint component 1      0          0</span></span>
<span><span class="co">#&gt;  6 ENSBTAG00000000149 rnaseq  joint component 1      0          0</span></span>
<span><span class="co">#&gt;  7 ENSBTAG00000000164 rnaseq  joint component 1      0          0</span></span>
<span><span class="co">#&gt;  8 ENSBTAG00000000205 rnaseq  joint component 1      0          0</span></span>
<span><span class="co">#&gt;  9 ENSBTAG00000000212 rnaseq  joint component 1      0          0</span></span>
<span><span class="co">#&gt; 10 ENSBTAG00000000289 rnaseq  joint component 1      0          0</span></span>
<span><span class="co">#&gt; # ℹ 2,308 more rows</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $samples_score</span></span>
<span><span class="co">#&gt; # A tibble: 973 × 3</span></span>
<span><span class="co">#&gt;    sample_id latent_dimension   score</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;     &lt;fct&gt;              &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 G1979     joint component 1  -8.12</span></span>
<span><span class="co">#&gt;  2 G2500     joint component 1  -9.81</span></span>
<span><span class="co">#&gt;  3 G3030     joint component 1  -9.93</span></span>
<span><span class="co">#&gt;  4 G3068     joint component 1 -14.7 </span></span>
<span><span class="co">#&gt;  5 G3121     joint component 1  -5.01</span></span>
<span><span class="co">#&gt;  6 G3315     joint component 1   9.66</span></span>
<span><span class="co">#&gt;  7 G3473     joint component 1   9.79</span></span>
<span><span class="co">#&gt;  8 G3474     joint component 1   9.99</span></span>
<span><span class="co">#&gt;  9 G3550     joint component 1  -9.70</span></span>
<span><span class="co">#&gt; 10 G3594     joint component 1   8.37</span></span>
<span><span class="co">#&gt; # ℹ 963 more rows</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $variance_explained</span></span>
<span><span class="co">#&gt; # A tibble: 8 × 3</span></span>
<span><span class="co">#&gt;   latent_dimension                dataset    prop_var_expl</span></span>
<span><span class="co">#&gt;   &lt;fct&gt;                           &lt;fct&gt;              &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 joint component 1               rnaseq            0.327 </span></span>
<span><span class="co">#&gt; 2 joint component 1               metabolome        0.150 </span></span>
<span><span class="co">#&gt; 3 rnaseq specific component 1     rnaseq            0.123 </span></span>
<span><span class="co">#&gt; 4 metabolome specific component 1 metabolome        0.107 </span></span>
<span><span class="co">#&gt; 5 metabolome specific component 2 metabolome        0.0767</span></span>
<span><span class="co">#&gt; 6 metabolome specific component 3 metabolome        0.0613</span></span>
<span><span class="co">#&gt; 7 metabolome specific component 4 metabolome        0.0605</span></span>
<span><span class="co">#&gt; 8 metabolome specific component 5 metabolome        0.0376</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "output_dimension_reduction"</span></span>
<span><span class="co">#&gt; attr(,"method")</span></span>
<span><span class="co">#&gt; [1] "sO2PLS"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="targets-chunk">
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>  <span class="va">mofa_output</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_output.html">get_output</a></span><span class="op">(</span><span class="va">mofa_trained</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_load.html">tar_load</a></span><span class="op">(</span><span class="va">mofa_output</span><span class="op">)</span></span>
<span><span class="va">mofa_output</span></span>
<span><span class="co">#&gt; $features_weight</span></span>
<span><span class="co">#&gt; # A tibble: 30,735 × 5</span></span>
<span><span class="co">#&gt;    feature_id                  dataset latent_dimension     weight importance</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;                       &lt;fct&gt;   &lt;fct&gt;                 &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 21-25977541-C-T-rs41974686  snps    Factor 1          0.000374      0.139 </span></span>
<span><span class="co">#&gt;  2 22-51403583-A-C-rs210306176 snps    Factor 1          0.0000535     0.0199</span></span>
<span><span class="co">#&gt;  3 24-12959068-G-T-rs381471286 snps    Factor 1          0.000268      0.0999</span></span>
<span><span class="co">#&gt;  4 8-85224224-T-C-rs43565287   snps    Factor 1         -0.000492      0.183 </span></span>
<span><span class="co">#&gt;  5 ARS-BFGL-BAC-16973          snps    Factor 1         -0.000883      0.329 </span></span>
<span><span class="co">#&gt;  6 ARS-BFGL-BAC-19403          snps    Factor 1         -0.000500      0.186 </span></span>
<span><span class="co">#&gt;  7 ARS-BFGL-BAC-2450           snps    Factor 1          0.000555      0.207 </span></span>
<span><span class="co">#&gt;  8 ARS-BFGL-BAC-2600           snps    Factor 1         -0.0000325     0.0121</span></span>
<span><span class="co">#&gt;  9 ARS-BFGL-BAC-27911          snps    Factor 1         -0.000568      0.212 </span></span>
<span><span class="co">#&gt; 10 ARS-BFGL-BAC-35925          snps    Factor 1          0.000803      0.299 </span></span>
<span><span class="co">#&gt; # ℹ 30,725 more rows</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $samples_score</span></span>
<span><span class="co">#&gt; # A tibble: 2,160 × 3</span></span>
<span><span class="co">#&gt;    sample_id latent_dimension score</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;     &lt;fct&gt;            &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 G1979     Factor 1          1.95</span></span>
<span><span class="co">#&gt;  2 G2500     Factor 1          1.98</span></span>
<span><span class="co">#&gt;  3 G3030     Factor 1          3.39</span></span>
<span><span class="co">#&gt;  4 G3068     Factor 1          3.65</span></span>
<span><span class="co">#&gt;  5 G3121     Factor 1          1.57</span></span>
<span><span class="co">#&gt;  6 G3315     Factor 1         -1.81</span></span>
<span><span class="co">#&gt;  7 G3473     Factor 1         -2.63</span></span>
<span><span class="co">#&gt;  8 G3474     Factor 1         -2.30</span></span>
<span><span class="co">#&gt;  9 G3550     Factor 1          2.98</span></span>
<span><span class="co">#&gt; 10 G3594     Factor 1         -1.88</span></span>
<span><span class="co">#&gt; # ℹ 2,150 more rows</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $variance_explained</span></span>
<span><span class="co">#&gt; # A tibble: 45 × 3</span></span>
<span><span class="co">#&gt;    latent_dimension dataset    prop_var_expl</span></span>
<span><span class="co">#&gt;    &lt;fct&gt;            &lt;fct&gt;              &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 Factor 1         snps           0.000313 </span></span>
<span><span class="co">#&gt;  2 Factor 1         rnaseq         0.496    </span></span>
<span><span class="co">#&gt;  3 Factor 1         metabolome     0.137    </span></span>
<span><span class="co">#&gt;  4 Factor 2         snps           0.239    </span></span>
<span><span class="co">#&gt;  5 Factor 2         rnaseq         0.000197 </span></span>
<span><span class="co">#&gt;  6 Factor 2         metabolome     0.0108   </span></span>
<span><span class="co">#&gt;  7 Factor 3         snps           0.000108 </span></span>
<span><span class="co">#&gt;  8 Factor 3         rnaseq         0.199    </span></span>
<span><span class="co">#&gt;  9 Factor 3         metabolome     0.0000872</span></span>
<span><span class="co">#&gt; 10 Factor 4         snps           0.0000927</span></span>
<span><span class="co">#&gt; # ℹ 35 more rows</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "output_dimension_reduction"</span></span>
<span><span class="co">#&gt; attr(,"method")</span></span>
<span><span class="co">#&gt; [1] "MOFA"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="targets-chunk">
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>  <span class="va">diablo_output</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_output.html">get_output</a></span><span class="op">(</span><span class="va">diablo_final_run</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_load.html">tar_load</a></span><span class="op">(</span><span class="va">diablo_output</span><span class="op">)</span></span>
<span><span class="va">diablo_output</span></span>
<span><span class="co">#&gt; $features_weight</span></span>
<span><span class="co">#&gt; # A tibble: 8,196 × 5</span></span>
<span><span class="co">#&gt;    feature_id                  dataset latent_dimension weight importance</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;                       &lt;fct&gt;   &lt;fct&gt;             &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 21-25977541-C-T-rs41974686  snps    Component 1           0          0</span></span>
<span><span class="co">#&gt;  2 22-51403583-A-C-rs210306176 snps    Component 1           0          0</span></span>
<span><span class="co">#&gt;  3 24-12959068-G-T-rs381471286 snps    Component 1           0          0</span></span>
<span><span class="co">#&gt;  4 8-85224224-T-C-rs43565287   snps    Component 1           0          0</span></span>
<span><span class="co">#&gt;  5 ARS-BFGL-BAC-16973          snps    Component 1           0          0</span></span>
<span><span class="co">#&gt;  6 ARS-BFGL-BAC-19403          snps    Component 1           0          0</span></span>
<span><span class="co">#&gt;  7 ARS-BFGL-BAC-2450           snps    Component 1           0          0</span></span>
<span><span class="co">#&gt;  8 ARS-BFGL-BAC-2600           snps    Component 1           0          0</span></span>
<span><span class="co">#&gt;  9 ARS-BFGL-BAC-27911          snps    Component 1           0          0</span></span>
<span><span class="co">#&gt; 10 ARS-BFGL-BAC-35925          snps    Component 1           0          0</span></span>
<span><span class="co">#&gt; # ℹ 8,186 more rows</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $samples_score</span></span>
<span><span class="co">#&gt; # A tibble: 540 × 3</span></span>
<span><span class="co">#&gt;    sample_id latent_dimension score</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;     &lt;fct&gt;            &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 G1979     Component 1       1.97</span></span>
<span><span class="co">#&gt;  2 G2500     Component 1       1.50</span></span>
<span><span class="co">#&gt;  3 G3030     Component 1       3.57</span></span>
<span><span class="co">#&gt;  4 G3068     Component 1       3.50</span></span>
<span><span class="co">#&gt;  5 G3121     Component 1       2.13</span></span>
<span><span class="co">#&gt;  6 G3315     Component 1      -3.26</span></span>
<span><span class="co">#&gt;  7 G3473     Component 1      -3.97</span></span>
<span><span class="co">#&gt;  8 G3474     Component 1      -3.20</span></span>
<span><span class="co">#&gt;  9 G3550     Component 1       2.46</span></span>
<span><span class="co">#&gt; 10 G3594     Component 1      -2.38</span></span>
<span><span class="co">#&gt; # ℹ 530 more rows</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $variance_explained</span></span>
<span><span class="co">#&gt; # A tibble: 12 × 3</span></span>
<span><span class="co">#&gt;    latent_dimension dataset    prop_var_expl</span></span>
<span><span class="co">#&gt;    &lt;fct&gt;            &lt;fct&gt;              &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 Component 1      snps             0.0698 </span></span>
<span><span class="co">#&gt;  2 Component 1      rnaseq           0.201  </span></span>
<span><span class="co">#&gt;  3 Component 1      metabolome       0.171  </span></span>
<span><span class="co">#&gt;  4 Component 2      snps             0.0213 </span></span>
<span><span class="co">#&gt;  5 Component 2      rnaseq           0.0801 </span></span>
<span><span class="co">#&gt;  6 Component 2      metabolome       0.0521 </span></span>
<span><span class="co">#&gt;  7 Component 3      snps             0.00898</span></span>
<span><span class="co">#&gt;  8 Component 3      rnaseq           0.149  </span></span>
<span><span class="co">#&gt;  9 Component 3      metabolome       0.0634 </span></span>
<span><span class="co">#&gt; 10 Component 4      snps             0.0136 </span></span>
<span><span class="co">#&gt; 11 Component 4      rnaseq           0.0601 </span></span>
<span><span class="co">#&gt; 12 Component 4      metabolome       0.0399 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "output_dimension_reduction"</span></span>
<span><span class="co">#&gt; attr(,"method")</span></span>
<span><span class="co">#&gt; [1] "DIABLO"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>The <code>features_weight</code> tibble contains one row per combination of feature and latent dimension. The ID of the features and the name of the dataset from which they originate are stored in the <code>feature_id</code> and <code>dataset</code> columns, respectively. The <code>latent_dimension</code> column gives the name of the latent dimension; this is a factor column. For each feature and latent dimension, the <code>weight</code> column shows the weight that was attributed to the feature for the corresponding latent dimension. In addition, the <code>importance</code> column contains the features <strong>importance score</strong>, which is computed as the absolute value of the features weight, divided by the maximum absolute weight across all features from the same omics dataset for the corresponding latent dimension. This importance score allows us to compare the contribution of the features across latent dimensions or integration methods, as the weight can be on different scales and thus cannot be directly compared. The importance scores range from 0 to 1. For any method performing feature selection (e.g.&nbsp;sPLS or DIABLO), features that were not selected for a given latent dimension are assigned a weight and importance score of 0.</p>
<p>The <code>samples score</code> tibble contains for each sample (<code>sample_id</code>) and latent dimension (<code>latent_dimension</code>) the sample’s coordinate for the corresponding latent dimension.</p>
<p>The <code>variance_explained</code> tibble gives for each latent dimension (<code>latent_dimension</code>) the proportion of variance explained (<code>prop_var_expl</code>) for each dataset (<code>dataset</code>). The values in <code>prop_var_expl</code> are between 0 and 1.</p>
<p>In addition, the name of the integration method used to obtain these results is stored in the <code>method</code> attribute of the <code>output_dimension_reduction</code> object:</p>
<div class="panel-tabset" data-group="method">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">sPLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">sO2PLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">MOFA</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">DIABLO</a></li>
</ul>
<div class="tab-content" data-group="method">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">spls_output</span>, <span class="st">"method"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "sPLS"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">so2pls_output</span>, <span class="st">"method"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "sO2PLS"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">mofa_output</span>, <span class="st">"method"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "MOFA"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">diablo_output</span>, <span class="st">"method"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "DIABLO"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>For convenience, the <code><a href="https://rdrr.io/pkg/moiraine/man/get_latent_dimensions.html">get_latent_dimensions()</a></code> function can be used on an <code>output_dimension_reduction</code> object to see the names of the latent dimensions (the levels used for the <code>latent_dimension</code> column in each tibble):</p>
<div class="panel-tabset" data-group="method">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">sPLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">sO2PLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">MOFA</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">DIABLO</a></li>
</ul>
<div class="tab-content" data-group="method">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_latent_dimensions.html">get_latent_dimensions</a></span><span class="op">(</span><span class="va">spls_output</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Component 1" "Component 2"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_latent_dimensions.html">get_latent_dimensions</a></span><span class="op">(</span><span class="va">so2pls_output</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "joint component 1"               "rnaseq specific component 1"    </span></span>
<span><span class="co">#&gt; [3] "metabolome specific component 1" "metabolome specific component 2"</span></span>
<span><span class="co">#&gt; [5] "metabolome specific component 3" "metabolome specific component 4"</span></span>
<span><span class="co">#&gt; [7] "metabolome specific component 5"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_latent_dimensions.html">get_latent_dimensions</a></span><span class="op">(</span><span class="va">mofa_output</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "Factor 1"  "Factor 2"  "Factor 3"  "Factor 4"  "Factor 5"  "Factor 6" </span></span>
<span><span class="co">#&gt;  [7] "Factor 7"  "Factor 8"  "Factor 9"  "Factor 10" "Factor 11" "Factor 12"</span></span>
<span><span class="co">#&gt; [13] "Factor 13" "Factor 14" "Factor 15"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_latent_dimensions.html">get_latent_dimensions</a></span><span class="op">(</span><span class="va">diablo_output</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Component 1" "Component 2" "Component 3" "Component 4"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Other methods covered by <code>get_output</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that both PCA and sPLS-DA (the method used for supervised features preselection in <a href="prefiltering.html#sec-prefiltering-supervised"><span>Section&nbsp;7.3.2</span></a>) are also dimension reduction methods. Therefore, the <code><a href="https://rdrr.io/pkg/moiraine/man/get_output.html">get_output()</a></code> function also converts <code>pcaRes</code> objects (from <code><a href="https://rdrr.io/pkg/moiraine/man/run_pca.html">run_pca()</a></code> or <code><a href="https://rdrr.io/pkg/pcaMethods/man/pca.html">pcaMethods::pca()</a></code>) and <code>mixo_splsda</code> objects (from <code><a href="https://rdrr.io/pkg/moiraine/man/run_splsda.html">run_splsda()</a></code> or <code><a href="https://rdrr.io/pkg/mixOmics/man/splsda.html">mixOmics::splsda()</a></code>) into <code>output_dimension_reduction</code> objects.</p>
</div>
</div>
</section><section id="averaging-latent-dimensions-over-datasets" class="level3" data-number="12.2.2"><h3 data-number="12.2.2" class="anchored" data-anchor-id="averaging-latent-dimensions-over-datasets">
<span class="header-section-number">12.2.2</span> Averaging latent dimensions over datasets</h3>
<p>While MOFA computes one score per sample for each latent dimension created, sPLS, sO2PLS and DIABLO all compute one score per dataset for each sample and latent dimension. For each latent dimension, the samples score obtained for the different datasets are then compared, to assess the agreement or covariation between datasets. Ideally, these scores should be highly correlated across datasets, since the methods aim at maximising the variation between datasets, but it is not always the case. However, when they are highly correlated, it becomes redundant to interpret each dataset-specific version of the latent dimensions.</p>
<p>Instead, the <code>mixOmics</code> authors proposed a solution for <code>DIABLO</code>, which is to construct a weighted average space in which to represent the samples: for each latent component, the samples score are averaged over the different datasets. The weight attributed to each dataset is determined by how well the corresponding dataset discriminates between the samples group of interest. This way, rather than looking at samples score for each dataset for any given latent component, we can look at an average of them.</p>
<p>The <code><a href="https://rdrr.io/pkg/moiraine/man/get_output.html">get_output()</a></code> function uses this idea to construct, for the output of sPLS, sO2PLS and DIABLO a set of average samples score for each latent dimension, rather than returning a set of samples score per dataset. For DIABLO, the average is weighted as explained above, while for sPLS and sO2PLS each dataset is given equal weight in the average. This calculation can be disabled in the <code><a href="https://rdrr.io/pkg/moiraine/man/get_output.html">get_output()</a></code> function to extract the dataset-specific samples score, by setting the <code>use_average_dimensions</code> parameter to <code>FALSE</code>. Note that this only affects the <code>samples_score</code> tibble in terms of dimensions, but the name of the latent dimensions will change to reflect the dataset to which they refer.</p>
<div class="panel-tabset" data-group="method">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">sPLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">sO2PLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">DIABLO</a></li>
</ul>
<div class="tab-content" data-group="method">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="targets-chunk">
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>  <span class="va">spls_output_no_average</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_output.html">get_output</a></span><span class="op">(</span><span class="va">spls_final_run</span>, use_average_dimensions <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_load.html">tar_load</a></span><span class="op">(</span><span class="va">spls_output_no_average</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_latent_dimensions.html">get_latent_dimensions</a></span><span class="op">(</span><span class="va">spls_output_no_average</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "rnaseq Component 1"     "metabolome Component 1" "rnaseq Component 2"    </span></span>
<span><span class="co">#&gt; [4] "metabolome Component 2"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">spls_output</span><span class="op">$</span><span class="va">samples_score</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 278</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">spls_output_no_average</span><span class="op">$</span><span class="va">samples_score</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 556</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="targets-chunk">
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>  <span class="va">so2pls_output_no_average</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_output.html">get_output</a></span><span class="op">(</span><span class="va">so2pls_final_run</span>, use_average_dimensions <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_load.html">tar_load</a></span><span class="op">(</span><span class="va">so2pls_output_no_average</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_latent_dimensions.html">get_latent_dimensions</a></span><span class="op">(</span><span class="va">so2pls_output_no_average</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "rnaseq joint component 1"        "metabolome joint component 1"   </span></span>
<span><span class="co">#&gt; [3] "rnaseq specific component 1"     "metabolome specific component 1"</span></span>
<span><span class="co">#&gt; [5] "metabolome specific component 2" "metabolome specific component 3"</span></span>
<span><span class="co">#&gt; [7] "metabolome specific component 4" "metabolome specific component 5"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">so2pls_output</span><span class="op">$</span><span class="va">samples_score</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 973</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">so2pls_output_no_average</span><span class="op">$</span><span class="va">samples_score</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1112</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="targets-chunk">
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>  <span class="va">diablo_output_no_average</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_output.html">get_output</a></span><span class="op">(</span><span class="va">diablo_final_run</span>, use_average_dimensions <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_load.html">tar_load</a></span><span class="op">(</span><span class="va">diablo_output_no_average</span><span class="op">)</span></span>
<span>  </span>
<span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_latent_dimensions.html">get_latent_dimensions</a></span><span class="op">(</span><span class="va">diablo_output_no_average</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "snps Component 1"       "rnaseq Component 1"     "metabolome Component 1"</span></span>
<span><span class="co">#&gt;  [4] "snps Component 2"       "rnaseq Component 2"     "metabolome Component 2"</span></span>
<span><span class="co">#&gt;  [7] "snps Component 3"       "rnaseq Component 3"     "metabolome Component 3"</span></span>
<span><span class="co">#&gt; [10] "snps Component 4"       "rnaseq Component 4"     "metabolome Component 4"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">diablo_output</span><span class="op">$</span><span class="va">samples_score</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 540</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">diablo_output_no_average</span><span class="op">$</span><span class="va">samples_score</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1620</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section></section><section id="percentage-of-variance-explained" class="level2" data-number="12.3"><h2 data-number="12.3" class="anchored" data-anchor-id="percentage-of-variance-explained">
<span class="header-section-number">12.3</span> Percentage of variance explained</h2>
<p>The first step in interpreting the results of a dimension reduction method is to assess how much variance is explained by the different latent dimensions for each dataset. The function <code><a href="https://rdrr.io/pkg/moiraine/man/plot_variance_explained.html">plot_variance_explained()</a></code> takes as input a <code>output_dimension_reduction</code> object and constructs a dataset-specific screeplot:</p>
<div class="panel-tabset" data-group="method">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">sPLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">sO2PLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">MOFA</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">DIABLO</a></li>
</ul>
<div class="tab-content" data-group="method">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_variance_explained.html">plot_variance_explained</a></span><span class="op">(</span><span class="va">spls_output</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/plot-variance-explained-spls-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_variance_explained.html">plot_variance_explained</a></span><span class="op">(</span><span class="va">so2pls_output</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span>, angle <span class="op">=</span> <span class="fl">30</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/plot-variance-explained-so2pls-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_variance_explained.html">plot_variance_explained</a></span><span class="op">(</span><span class="va">mofa_output</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span>, angle <span class="op">=</span> <span class="fl">30</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/plot-variance-explained-mofa-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_variance_explained.html">plot_variance_explained</a></span><span class="op">(</span><span class="va">diablo_output</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/plot-variance-explained-diablo-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
</div>
</div>
</section><section id="sec-interpretation-samples-scores" class="level2" data-number="12.4"><h2 data-number="12.4" class="anchored" data-anchor-id="sec-interpretation-samples-scores">
<span class="header-section-number">12.4</span> Samples plot</h2>
<p>To understand the phenomenon driving the variation represented by the different latent components, we can investigate the coordinates of the samples in the space spanned by these latent components, in combination with information that we have about the samples.</p>
<p>We will start by loading the <code>MultiDataSet</code> object and generating some custom colour palettes for different samples covariates of interest, that we will use in the rest of the section.</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_load.html">tar_load</a></span><span class="op">(</span><span class="va">mo_set_complete</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Choosing colour palettes for the samples covariates</span></span>
<span><span class="va">palette_status</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_colour_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span></span>
<span><span class="va">palette_feedlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_colour_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set2"</span><span class="op">)</span></span>
<span><span class="va">palette_geno_comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_colour_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span></span>
<span><span class="va">palette_rnaseq_batch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_colour_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Paired"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## For some plots will need both colour and fill</span></span>
<span><span class="va">palette_status_fill</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_colour_brewer</a></span><span class="op">(</span></span>
<span>  palette <span class="op">=</span> <span class="st">"Set1"</span>, </span>
<span>  aesthetics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"colour"</span>, <span class="st">"fill"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="sec-interpretation-samples-ggpairs" class="level3" data-number="12.4.1"><h3 data-number="12.4.1" class="anchored" data-anchor-id="sec-interpretation-samples-ggpairs">
<span class="header-section-number">12.4.1</span> Matrix of scatter plots</h3>
<p>The <code><a href="https://rdrr.io/pkg/moiraine/man/plot_samples_score.html">plot_samples_score()</a></code> function shows the samples score in a matrix of scatter plots that represent all possible two-by-two combinations of the latent dimensions. The plots in the resulting matrix are redundant: the lower plots (below the diagonal) are just a rotated version of the upper plots (above the diagonal). The function takes as input an <code>output_dimension_reduction</code> object. In addition, it accepts a <code>MultiDataSet</code> object to extract information about the samples that can then be used to customise the plot. Since the plots are redundant, different properties of the samples can be shown in the upper and lower plots. For example, we will colour the samples according to disease status in the upper plots, while representing some other covariate in the lower plots. We will use the shape of the points to illustrate gender in both upper and lower plots. By default, all latent dimensions are included in the plots, but it is possible to select some of them by passing their names to the <code>latent_dimensions</code> argument. There are more options to further customise the plot, which are shown in the function’s help.</p>
<div class="panel-tabset" data-group="method">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">sPLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">sO2PLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">MOFA</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false">DIABLO</a></li>
</ul>
<div class="tab-content" data-group="method">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_samples_score.html">plot_samples_score</a></span><span class="op">(</span></span>
<span>  <span class="va">spls_output</span>,</span>
<span>  mo_data <span class="op">=</span> <span class="va">mo_set_complete</span>,</span>
<span>  colour_upper <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>  scale_colour_upper <span class="op">=</span> <span class="va">palette_status</span>,</span>
<span>  shape_upper <span class="op">=</span> <span class="st">"gender"</span>,</span>
<span>  colour_lower <span class="op">=</span> <span class="st">"feedlot"</span>,</span>
<span>  scale_colour_lower <span class="op">=</span> <span class="va">palette_feedlot</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.box <span class="op">=</span> <span class="st">"vertical"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/spls-plot-samples-scores-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Component 1 clearly splits the control and BRD animals, while component 2 seems to separate two samples from the rest. There is no clear separation of the samples by feedlot or gender.</p>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p>Here we will focus on the joint components. Since there is only one, instead of a matrix of scatterplot, the function will display the samples score with a violin plot, and the properties selected for the upper plots will be used to customise the points:</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_samples_score.html">plot_samples_score</a></span><span class="op">(</span></span>
<span>  <span class="va">so2pls_output</span>,</span>
<span>  latent_dimensions <span class="op">=</span> <span class="st">"joint component 1"</span>,</span>
<span>  mo_data <span class="op">=</span> <span class="va">mo_set_complete</span>,</span>
<span>  colour_upper <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>  scale_colour_upper <span class="op">=</span> <span class="va">palette_status</span>,</span>
<span>  shape_upper <span class="op">=</span> <span class="st">"gender"</span>,</span>
<span>  colour_lower <span class="op">=</span> <span class="st">"feedlot"</span>,</span>
<span>  scale_colour_lower <span class="op">=</span> <span class="va">palette_feedlot</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in plot_samples_score(so2pls_output, latent_dimensions = "joint</span></span>
<span><span class="co">#&gt; component 1", : Only one latent dimension to plot; 'colour_diag',</span></span>
<span><span class="co">#&gt; 'colour_lower' and 'shape_lower' argument will be ignored.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/so2pls-plot-samples-scores-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Joint component 1 separates the BRD and control animals, although some of them overlap.</p>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<p>For clarity we will focus here on the first four factors:</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_samples_score.html">plot_samples_score</a></span><span class="op">(</span></span>
<span>  <span class="va">mofa_output</span>,</span>
<span>  latent_dimensions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Factor"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>  mo_data <span class="op">=</span> <span class="va">mo_set_complete</span>,</span>
<span>  colour_upper <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>  scale_colour_upper <span class="op">=</span> <span class="va">palette_status</span>,</span>
<span>  shape_upper <span class="op">=</span> <span class="st">"gender"</span>,</span>
<span>  colour_lower <span class="op">=</span> <span class="st">"geno_comp_cluster"</span>,</span>
<span>  scale_colour_lower <span class="op">=</span> <span class="va">palette_geno_comp</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.box <span class="op">=</span> <span class="st">"vertical"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing missing values (`geom_point()`).</span></span>
<span><span class="co">#&gt; Removed 2 rows containing missing values (`geom_point()`).</span></span>
<span><span class="co">#&gt; Removed 2 rows containing missing values (`geom_point()`).</span></span>
<span><span class="co">#&gt; Removed 2 rows containing missing values (`geom_point()`).</span></span>
<span><span class="co">#&gt; Removed 2 rows containing missing values (`geom_point()`).</span></span>
<span><span class="co">#&gt; Removed 2 rows containing missing values (`geom_point()`).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/mofa-plot-samples-scores-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Factor 1 clearly separates the control and BRD animals. Factor 2 separates samples from the genomics composition cluster K1 from the other two clusters. None of the factors are separating the animals by gender, indicating that this covariate does not have a strong effect in the omics measurements.</p>
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_samples_score.html">plot_samples_score</a></span><span class="op">(</span></span>
<span>  <span class="va">diablo_output</span>,</span>
<span>  mo_data <span class="op">=</span> <span class="va">mo_set_complete</span>,</span>
<span>  colour_upper <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>  scale_colour_upper <span class="op">=</span> <span class="va">palette_status</span>,</span>
<span>  shape_upper <span class="op">=</span> <span class="st">"gender"</span>,</span>
<span>  colour_lower <span class="op">=</span> <span class="st">"rnaseq_batch"</span>,</span>
<span>  scale_colour_lower <span class="op">=</span> <span class="va">palette_rnaseq_batch</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.box <span class="op">=</span> <span class="st">"vertical"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/diablo-plot-samples-scores-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>As DIABLO is a supervised method, it is no surprise that the first component clearly separates the two disease status groups. The second latent component separates samples according to the RNAseq batch. From this plot it is not clear what components 3 and 4 represent.</p>
</div>
</div>
</div>
</section><section id="sec-interpretation-samples-pair" class="level3" data-number="12.4.2"><h3 data-number="12.4.2" class="anchored" data-anchor-id="sec-interpretation-samples-pair">
<span class="header-section-number">12.4.2</span> Scatter plot for pair of latent dimensions</h3>
<p>We can also focus on a specific pair of latent dimensions and represent the samples in the space spanned by these two dimensions, with the <code><a href="https://rdrr.io/pkg/moiraine/man/plot_samples_score_pair.html">plot_samples_score_pair()</a></code> function. The two latent dimensions to plot are selected by passing their names to the function. This function also accepts a <code>MultiDataSet</code> object, whose samples metadata will be used to customise the plot.</p>
<div class="panel-tabset" data-group="method">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">sPLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">sO2PLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">MOFA</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-4" role="tab" aria-controls="tabset-7-4" aria-selected="false">DIABLO</a></li>
</ul>
<div class="tab-content" data-group="method">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_samples_score_pair.html">plot_samples_score_pair</a></span><span class="op">(</span></span>
<span>  <span class="va">spls_output</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Component"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  mo_data <span class="op">=</span> <span class="va">mo_set_complete</span>,</span>
<span>  colour_by <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>  shape_by <span class="op">=</span> <span class="st">"gender"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">palette_status</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/spls-plot-samples-score-pair-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>The two disease status groups are well separated in this space.</p>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>To showcase this function, we will look at the first two metabolomics-specific latent components:</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_samples_score_pair.html">plot_samples_score_pair</a></span><span class="op">(</span></span>
<span>  <span class="va">so2pls_output</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"metabolome specific component"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  mo_data <span class="op">=</span> <span class="va">mo_set_complete</span>,</span>
<span>  colour_by <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>  shape_by <span class="op">=</span> <span class="st">"gender"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">palette_status</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/so2pls-plot-samples-score-pair-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>These two specific components are not related to disease status or gender.</p>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_samples_score_pair.html">plot_samples_score_pair</a></span><span class="op">(</span></span>
<span>  <span class="va">mofa_output</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Factor"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  mo_data <span class="op">=</span> <span class="va">mo_set_complete</span>,</span>
<span>  colour_by <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>  shape_by <span class="op">=</span> <span class="st">"geno_comp_cluster"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">palette_status</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing missing values (`geom_point()`).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/mofa-plot-samples-score-pair-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>We see that these first two factors discriminate the disease status groups and the genomics composition clusters.</p>
</div>
<div id="tabset-7-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-4-tab">
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_samples_score_pair.html">plot_samples_score_pair</a></span><span class="op">(</span></span>
<span>  <span class="va">diablo_output</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Component"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  mo_data <span class="op">=</span> <span class="va">mo_set_complete</span>,</span>
<span>  colour_by <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>  shape_by <span class="op">=</span> <span class="st">"rnaseq_batch"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">palette_status</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/diablo-plot-samples-score-pair-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>We see that these first two components discriminate the disease status groups and the RNAseq batches.</p>
</div>
</div>
</div>
</section><section id="sec-interpretation-samples-covariate" class="level3" data-number="12.4.3"><h3 data-number="12.4.3" class="anchored" data-anchor-id="sec-interpretation-samples-covariate">
<span class="header-section-number">12.4.3</span> Samples score vs covariate</h3>
<p>Lastly, we can plot the samples score for each latent dimension against a samples covariate of interest, with the <code><a href="https://rdrr.io/pkg/moiraine/man/plot_samples_score_covariate.html">plot_samples_score_covariate()</a></code> function. This is useful to focus on one dimension at a time rather than pairs of them. By default, the function displays all latent dimensions, but we can focus on a subset of them through the <code>latent_dimensions</code> arguments. The function needs a <code>MultiDataSet</code> object to extract information about the samples. The plot generated will depend on whether the covariate of interest is categorical or continuous. We will show both options below. In addition to the main covariate of interest that will be displayed on the x-axis, the colour and shape of the points can be further customised according to other samples properties.</p>
<p>First, with a categorical covariate:</p>
<div class="panel-tabset" data-group="method">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">sPLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">sO2PLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">MOFA</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-4" role="tab" aria-controls="tabset-8-4" aria-selected="false">DIABLO</a></li>
</ul>
<div class="tab-content" data-group="method">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_samples_score_covariate.html">plot_samples_score_covariate</a></span><span class="op">(</span></span>
<span>  <span class="va">spls_output</span>,</span>
<span>  <span class="va">mo_set_complete</span>,</span>
<span>  <span class="st">"status"</span>,</span>
<span>  colour_by <span class="op">=</span> <span class="st">"status"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">palette_status_fill</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/spls-plot-samples-score-covariate-cat-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<p>For clarity we will focus on the first joint component only.</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_samples_score_covariate.html">plot_samples_score_covariate</a></span><span class="op">(</span></span>
<span>  <span class="va">so2pls_output</span>,</span>
<span>  <span class="va">mo_set_complete</span>,</span>
<span>  <span class="st">"status"</span>,</span>
<span>  colour_by <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>  latent_dimensions <span class="op">=</span> <span class="st">"joint component 1"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">palette_status_fill</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/so2pls-plot-samples-score-covariate-cat-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<p>For clarity we will focus on the first two factors only.</p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_samples_score_covariate.html">plot_samples_score_covariate</a></span><span class="op">(</span></span>
<span>  <span class="va">mofa_output</span>,</span>
<span>  <span class="va">mo_set_complete</span>,</span>
<span>  <span class="st">"status"</span>,</span>
<span>  colour_by <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>  shape_by <span class="op">=</span> <span class="st">"geno_comp_cluster"</span>,</span>
<span>  latent_dimensions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Factor"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">palette_status_fill</span></span>
<span><span class="co">#&gt; Warning: Removed 4 rows containing missing values (`geom_point()`).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/mofa-plot-samples-score-covariate-cat-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
<div id="tabset-8-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-4-tab">
<p>For clarity we will focus on the first two components only.</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_samples_score_covariate.html">plot_samples_score_covariate</a></span><span class="op">(</span></span>
<span>  <span class="va">diablo_output</span>,</span>
<span>  <span class="va">mo_set_complete</span>,</span>
<span>  <span class="st">"status"</span>,</span>
<span>  colour_by <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>  shape_by <span class="op">=</span> <span class="st">"rnaseq_batch"</span>,</span>
<span>  latent_dimensions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Component"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">palette_status_fill</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/diablo-plot-samples-score-covariate-cat-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
</div>
</div>
<p>Now, with a continuous covariate:</p>
<div class="panel-tabset" data-group="method">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">sPLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">sO2PLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">MOFA</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-4" role="tab" aria-controls="tabset-9-4" aria-selected="false">DIABLO</a></li>
</ul>
<div class="tab-content" data-group="method">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_samples_score_covariate.html">plot_samples_score_covariate</a></span><span class="op">(</span></span>
<span>  <span class="va">spls_output</span>,</span>
<span>  <span class="va">mo_set_complete</span>,</span>
<span>  <span class="st">"day_on_feed"</span>,</span>
<span>  colour_by <span class="op">=</span> <span class="st">"status"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">palette_status_fill</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/spls-plot-samples-score-covariate-cont-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<p>For clarity we will focus on the first joint component only.</p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_samples_score_covariate.html">plot_samples_score_covariate</a></span><span class="op">(</span></span>
<span>  <span class="va">so2pls_output</span>,</span>
<span>  <span class="va">mo_set_complete</span>,</span>
<span>  <span class="st">"day_on_feed"</span>,</span>
<span>  colour_by <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>  latent_dimensions <span class="op">=</span> <span class="st">"joint component 1"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">palette_status_fill</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/so2pls-plot-samples-score-covariate-cont-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<p>For clarity we will focus on the first two factors only.</p>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_samples_score_covariate.html">plot_samples_score_covariate</a></span><span class="op">(</span></span>
<span>  <span class="va">mofa_output</span>,</span>
<span>  <span class="va">mo_set_complete</span>,</span>
<span>  <span class="st">"day_on_feed"</span>,</span>
<span>  colour_by <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>  shape_by <span class="op">=</span> <span class="st">"geno_comp_cluster"</span>,</span>
<span>  latent_dimensions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Factor"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">palette_status_fill</span></span>
<span><span class="co">#&gt; Warning: Removed 4 rows containing non-finite values (`stat_smooth()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 4 rows containing missing values (`geom_point()`).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/mofa-plot-samples-score-covariate-cont-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
<div id="tabset-9-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-4-tab">
<p>For clarity we will focus on the first two components only.</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_samples_score_covariate.html">plot_samples_score_covariate</a></span><span class="op">(</span></span>
<span>  <span class="va">diablo_output</span>,</span>
<span>  <span class="va">mo_set_complete</span>,</span>
<span>  <span class="st">"day_on_feed"</span>,</span>
<span>  colour_by <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>  shape_by <span class="op">=</span> <span class="st">"rnaseq_batch"</span>,</span>
<span>  latent_dimensions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Component"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">palette_status_fill</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/diablo-plot-samples-score-covariate-cont-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="feature-plots" class="level2" data-number="12.5"><h2 data-number="12.5" class="anchored" data-anchor-id="feature-plots">
<span class="header-section-number">12.5</span> Feature plots</h2>
<p>Next, we can have a look at the features contributing to each latent dimension.</p>
<section id="sec-interpretation-features-distr" class="level3" data-number="12.5.1"><h3 data-number="12.5.1" class="anchored" data-anchor-id="sec-interpretation-features-distr">
<span class="header-section-number">12.5.1</span> Features weight distribution</h3>
<p>We can start by looking at the distribution of features weight for each latent dimension across the datasets, with the <code><a href="https://rdrr.io/pkg/moiraine/man/plot_features_weight_distr.html">plot_features_weight_distr()</a></code> function. Again, the function takes an <code>output_dimension_reduction</code> object as first input; by default it will show all latent dimensions and datasets, but they can be specified through the <code>latent_dimensions</code> and <code>datasets</code> arguments. The function shows by default the distribution of the “signed” importance scores, i.e.&nbsp;the features weights normalised by the highest absolute weight value for the corresponding latent dimension and dataset, but we can also show the distribution of importance scores (which are absolute values) and non-transformed features weight (through the <code>features_metric</code> argument). Note that the function returns a <a href="https://patchwork.data-imaginist.com/">patchwork</a> of ggplots.</p>
<div class="panel-tabset" data-group="method">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">sPLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">sO2PLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false">MOFA</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-4" role="tab" aria-controls="tabset-10-4" aria-selected="false">DIABLO</a></li>
</ul>
<div class="tab-content" data-group="method">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_features_weight_distr.html">plot_features_weight_distr</a></span><span class="op">(</span><span class="va">spls_output</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/spls-plot-features-weight-distr-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>As sPLS performs feature selection, most of the weights are equal to 0.</p>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_features_weight_distr.html">plot_features_weight_distr</a></span><span class="op">(</span><span class="va">so2pls_output</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">## showing two plots per column (from patchwork package)</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/so2pls-plot-features-weight-distr-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>As sO2PLS performs feature selection for the joint components, most of the weights are equal to 0 for joint component 1.</p>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<p>We will only look at factors 1 to 4 for clarity:</p>
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_features_weight_distr.html">plot_features_weight_distr</a></span><span class="op">(</span></span>
<span>  <span class="va">mofa_output</span>,</span>
<span>  latent_dimensions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Factor"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">## showing one plot per column (from patchwork package)</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/mofa-plot-features-weight-distr-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>We can see for example for factor 1 that only a couple of metabolites have an importance score above 0.5, this small number of features are driving the variation captured by factor 1.</p>
</div>
<div id="tabset-10-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-4-tab">
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_features_weight_distr.html">plot_features_weight_distr</a></span><span class="op">(</span></span>
<span>  <span class="va">diablo_output</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">## showing one plot per column (from patchwork package)</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/diablo-plot-features-weight-distr-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>As DIABLO performs feature selection, most of the weights are equal to zero.</p>
</div>
</div>
</div>
</section><section id="sec-interpretation-features-pair" class="level3" data-number="12.5.2"><h3 data-number="12.5.2" class="anchored" data-anchor-id="sec-interpretation-features-pair">
<span class="header-section-number">12.5.2</span> Comparing features importance between latent components</h3>
<p>We can also compare the importance score given to the features between any two latent dimensions with the <code><a href="https://rdrr.io/pkg/moiraine/man/plot_features_weight_pair.html">plot_features_weight_pair()</a></code> function.</p>
<div class="panel-tabset" data-group="method">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">sPLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">sO2PLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false">MOFA</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-4" role="tab" aria-controls="tabset-11-4" aria-selected="false">DIABLO</a></li>
</ul>
<div class="tab-content" data-group="method">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_features_weight_pair.html">plot_features_weight_pair</a></span><span class="op">(</span></span>
<span>  <span class="va">spls_output</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Component"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  mo_data <span class="op">=</span> <span class="va">mo_set_complete</span>,</span>
<span>  label_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"rnaseq"</span> <span class="op">=</span> <span class="st">"Name"</span>,</span>
<span>    <span class="st">"metabolome"</span> <span class="op">=</span> <span class="st">"name"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/spls-features-weight-pair-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>All genes and most metabolites selected for the two components are different.</p>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_features_weight_pair.html">plot_features_weight_pair</a></span><span class="op">(</span></span>
<span>  <span class="va">so2pls_output</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"metabolome specific component"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  mo_data <span class="op">=</span> <span class="va">mo_set_complete</span>,</span>
<span>  label_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"rnaseq"</span> <span class="op">=</span> <span class="st">"Name"</span>,</span>
<span>    <span class="st">"metabolome"</span> <span class="op">=</span> <span class="st">"name"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/so2pls-features-weight-pair-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>The plot shows an interesting pattern: the weights of the compound for these two specific components are negatively correlated, except for a couple of outliers.</p>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_features_weight_pair.html">plot_features_weight_pair</a></span><span class="op">(</span></span>
<span>  <span class="va">mofa_output</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Factor"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  mo_data <span class="op">=</span> <span class="va">mo_set_complete</span>,</span>
<span>  label_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"rnaseq"</span> <span class="op">=</span> <span class="st">"Name"</span>,</span>
<span>    <span class="st">"metabolome"</span> <span class="op">=</span> <span class="st">"name"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/mofa-features-weight-pair-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>We can see that the genomic markers are mostly given weights of opposite signs for the first two MOFA factors (e.g.&nbsp;positive weight for factor 1 and negative weight for factor 2). For the transcriptomics and metabolomics datasets, the importance score are mostly uncorrelated between the first two factors.</p>
</div>
<div id="tabset-11-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-4-tab">
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_features_weight_pair.html">plot_features_weight_pair</a></span><span class="op">(</span></span>
<span>  <span class="va">diablo_output</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Component"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  mo_data <span class="op">=</span> <span class="va">mo_set_complete</span>,</span>
<span>  label_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"rnaseq"</span> <span class="op">=</span> <span class="st">"Name"</span>,</span>
<span>    <span class="st">"metabolome"</span> <span class="op">=</span> <span class="st">"name"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/diablo-features-weight-pair-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>We can see that different features were selected for the first two latent components from each omics dataset.</p>
</div>
</div>
</div>
<p>These plots allow us to quickly check whether different latent dimensions capture different or related aspects of the data. The top 5 features according to their consensus importance score (see <a href="comparison.html#sec-comparison-consensus"><span>Section&nbsp;14.9</span></a>) are highlighted in red.</p>
<p>By default, the function shows the signed importance score of the features, i.e.&nbsp;their importance score to which the sign of their weight was added. This can be changed through the <code>features_metric</code> argument of the function.</p>
</section><section id="sec-interpretation-features-top-plot" class="level3" data-number="12.5.3"><h3 data-number="12.5.3" class="anchored" data-anchor-id="sec-interpretation-features-top-plot">
<span class="header-section-number">12.5.3</span> Plotting top features weight</h3>
<p>We can then investigate which features are assigned the highest weights for each latent dimension. These are the features driving the variation captured by the latent components. This is done with the <code><a href="https://rdrr.io/pkg/moiraine/man/plot_top_features.html">plot_top_features()</a></code> function.</p>
<p>By default, the feature IDs will be used as labels in the plot, but by passing a <code>MultiDataSet</code> object to the function we can use a column from the features metadata table instead. To do so, we need to pass a named list to the <code>label_cols</code> argument: the names of the elements in the list should correspond to dataset names in the <code>MultiDataSet</code> object, and the value should be the name of the column in the features metadata table of the corresponding dataset to use as feature label. The number of features displayed is controlled through the <code>top_n</code> argument (the default value is 20). Note that if a lower number of features is selected for a certain dataset and latent dimension, only the selected features will be displayed. Again, the function returns a <a href="https://patchwork.data-imaginist.com/">patchwork</a> of ggplots.</p>
<div class="panel-tabset" data-group="method">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">sPLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">sO2PLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false">MOFA</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-4" role="tab" aria-controls="tabset-12-4" aria-selected="false">DIABLO</a></li>
</ul>
<div class="tab-content" data-group="method">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_top_features.html">plot_top_features</a></span><span class="op">(</span></span>
<span>  <span class="va">spls_output</span>,</span>
<span>  mo_data <span class="op">=</span> <span class="va">mo_set_complete</span>,</span>
<span>  label_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"rnaseq"</span> <span class="op">=</span> <span class="st">"Name"</span>,</span>
<span>    <span class="st">"metabolome"</span> <span class="op">=</span> <span class="st">"name"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/spls-plot-top-features-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>We can see that citric acid and D-mannose have an importance score close to 1 for component 1. Citric acid has a negative weight, meaning that its abundance is negatively correlated with component 1, while D-mannose has a positive weight, so its abundance is positively correlated with component 1. For the second component, only two genes have an importance score above 0.5.</p>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<p>We will focus on joint component 1:</p>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_top_features.html">plot_top_features</a></span><span class="op">(</span></span>
<span>  <span class="va">so2pls_output</span>,</span>
<span>  mo_data <span class="op">=</span> <span class="va">mo_set_complete</span>,</span>
<span>  label_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"rnaseq"</span> <span class="op">=</span> <span class="st">"Name"</span>,</span>
<span>    <span class="st">"metabolome"</span> <span class="op">=</span> <span class="st">"name"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  latent_dimensions <span class="op">=</span> <span class="st">"joint component 1"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/so2pls-plot-top-features-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>While all top 20 genes have an importance score above 0.5 for joint component 1, only citric acid is given a high importance score for joint component 1 in the metabolomics dataset.</p>
</div>
<div id="tabset-12-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<p>We will focus on the first two factors here:</p>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_top_features.html">plot_top_features</a></span><span class="op">(</span></span>
<span>  <span class="va">mofa_output</span>,</span>
<span>  mo_data <span class="op">=</span> <span class="va">mo_set_complete</span>,</span>
<span>  label_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"rnaseq"</span> <span class="op">=</span> <span class="st">"Name"</span>,</span>
<span>    <span class="st">"metabolome"</span> <span class="op">=</span> <span class="st">"name"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  latent_dimensions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Factor"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/mofa-plot-top-features-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>For factor 1, citric acid is the only metabolite with an importance score above 0.75, while in the genomics dataset four markers have a high importance score, and most of the top 20 genes have an importance score aroung 0.7 or higher.</p>
</div>
<div id="tabset-12-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-4-tab">
<p>For clarity, we will focus on the first two latent components:</p>
<div class="cell">
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_top_features.html">plot_top_features</a></span><span class="op">(</span></span>
<span>  <span class="va">diablo_output</span>,</span>
<span>  mo_data <span class="op">=</span> <span class="va">mo_set_complete</span>,</span>
<span>  label_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"rnaseq"</span> <span class="op">=</span> <span class="st">"Name"</span>,</span>
<span>    <span class="st">"metabolome"</span> <span class="op">=</span> <span class="st">"name"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  latent_dimensions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Component"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/diablo-plot-top-features-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>For component 1, we can see three markers from the genomics dataset and three genes with a high importance score. From the metabolomics dataset, less than 20 features were retained.</p>
</div>
</div>
</div>
</section><section id="sec-interpretation-features-top-table" class="level3" data-number="12.5.4"><h3 data-number="12.5.4" class="anchored" data-anchor-id="sec-interpretation-features-top-table">
<span class="header-section-number">12.5.4</span> Extracting top features</h3>
<p>It is also possible to extract information about the top contributing features as a table with the function <code><a href="https://rdrr.io/pkg/moiraine/man/get_top_features.html">get_top_features()</a></code>. The function offers two options:</p>
<ul>
<li><p>Return for each dataset the top N features contributing to the latent dimensions of interest. N is specified through the <code>n_features</code> argument;</p></li>
<li><p>Return for each dataset features whose importance score is at least equal to a certain threshold. The threshold is specified through the <code>min_importance</code> argument.</p></li>
</ul>
<p>The first option is preferred when many features contribute to a given factor. The second option has been implemented for cases where some latent dimensions are driven by a small number of features (so for example in the top 10 contributing features, only 3 features would actually have a high importance score). By default, the function returns the top contributing features from all datasets for all latent dimensions, but we can focus on some datasets and/or latent dimensions of interest by passing their names to the <code>datasets</code> and <code>latent_dimensions</code> arguments of the function. Additionally, we can pass to the function a <code>MultiDataSet</code> object (through the <code>mo_data</code> argument); the function will extract information about the features from the features metadata.</p>
<p>We illustrate the two possible options below. For the second option, we add features information to the table:</p>
<div class="panel-tabset" data-group="method">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">sPLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">sO2PLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false">MOFA</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-4" role="tab" aria-controls="tabset-13-4" aria-selected="false">DIABLO</a></li>
</ul>
<div class="tab-content" data-group="method">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_top_features.html">get_top_features</a></span><span class="op">(</span><span class="va">spls_output</span>, n_features <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   feature_id         dataset    latent_dimension weight importance</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;              &lt;fct&gt;      &lt;fct&gt;             &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 ENSBTAG00000022715 rnaseq     Component 1      -0.318      1    </span></span>
<span><span class="co">#&gt; 2 ENSBTAG00000050618 rnaseq     Component 1      -0.302      0.950</span></span>
<span><span class="co">#&gt; 3 ENSBTAG00000018223 rnaseq     Component 1      -0.291      0.916</span></span>
<span><span class="co">#&gt; 4 HMDB00094          metabolome Component 1       0.451      1    </span></span>
<span><span class="co">#&gt; 5 HMDB00169          metabolome Component 1      -0.327      0.726</span></span>
<span><span class="co">#&gt; 6 HMDB00159          metabolome Component 1      -0.312      0.692</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_top_features.html">get_top_features</a></span><span class="op">(</span></span>
<span>  <span class="va">spls_output</span>,</span>
<span>  min_importance <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  mo_data <span class="op">=</span> <span class="va">mo_set_complete</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 31</span></span>
<span><span class="co">#&gt;   feature_id      dataset latent_dimension weight importance chromosome  p_value</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;           &lt;fct&gt;   &lt;fct&gt;             &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 ENSBTAG0000002… rnaseq  Component 1      -0.318      1     26         1.79e-33</span></span>
<span><span class="co">#&gt; 2 ENSBTAG0000005… rnaseq  Component 1      -0.302      0.950 26         2.54e-33</span></span>
<span><span class="co">#&gt; 3 ENSBTAG0000001… rnaseq  Component 1      -0.291      0.916 16         7.14e-31</span></span>
<span><span class="co">#&gt; 4 ENSBTAG0000004… rnaseq  Component 1      -0.266      0.837 15         4.14e-36</span></span>
<span><span class="co">#&gt; 5 ENSBTAG0000003… rnaseq  Component 1      -0.264      0.831 7          1.22e-35</span></span>
<span><span class="co">#&gt; 6 HMDB00094       metabo… Component 1       0.451      1     &lt;NA&gt;       2.48e-41</span></span>
<span><span class="co">#&gt; # ℹ 24 more variables: fdr &lt;dbl&gt;, start &lt;int&gt;, end &lt;int&gt;, width &lt;int&gt;,</span></span>
<span><span class="co">#&gt; #   strand &lt;fct&gt;, Name &lt;chr&gt;, description &lt;chr&gt;, log_fc &lt;dbl&gt;, log_cpm &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   f &lt;dbl&gt;, de_signif &lt;chr&gt;, de_status &lt;chr&gt;, hmdb_id &lt;chr&gt;, name &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   chemical_formula &lt;chr&gt;, monisotopic_molecular_weight &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   cas_registry_number &lt;chr&gt;, smiles &lt;chr&gt;, inchikey &lt;chr&gt;, kegg_id &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   direct_parent &lt;chr&gt;, super_class &lt;chr&gt;, t_value &lt;dbl&gt;, padj &lt;dbl&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_top_features.html">get_top_features</a></span><span class="op">(</span><span class="va">so2pls_output</span>, n_features <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   feature_id         dataset    latent_dimension  weight importance</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;              &lt;fct&gt;      &lt;fct&gt;              &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 ENSBTAG00000048835 rnaseq     joint component 1 -0.268      1    </span></span>
<span><span class="co">#&gt; 2 ENSBTAG00000049569 rnaseq     joint component 1 -0.266      0.993</span></span>
<span><span class="co">#&gt; 3 ENSBTAG00000039037 rnaseq     joint component 1 -0.248      0.925</span></span>
<span><span class="co">#&gt; 4 HMDB00094          metabolome joint component 1  0.751      1    </span></span>
<span><span class="co">#&gt; 5 HMDB00042          metabolome joint component 1  0.335      0.445</span></span>
<span><span class="co">#&gt; 6 HMDB00357          metabolome joint component 1  0.319      0.424</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_top_features.html">get_top_features</a></span><span class="op">(</span></span>
<span>  <span class="va">so2pls_output</span>,</span>
<span>  min_importance <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  mo_data <span class="op">=</span> <span class="va">mo_set_complete</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 31</span></span>
<span><span class="co">#&gt;   feature_id      dataset latent_dimension weight importance chromosome  p_value</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;           &lt;fct&gt;   &lt;fct&gt;             &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 ENSBTAG0000004… rnaseq  joint component… -0.268      1     24         5.43e-27</span></span>
<span><span class="co">#&gt; 2 ENSBTAG0000004… rnaseq  joint component… -0.266      0.993 NKLS02001… 1.14e-27</span></span>
<span><span class="co">#&gt; 3 ENSBTAG0000003… rnaseq  joint component… -0.248      0.925 NKLS02001… 1.45e-28</span></span>
<span><span class="co">#&gt; 4 ENSBTAG0000003… rnaseq  joint component… -0.235      0.876 7          1.22e-35</span></span>
<span><span class="co">#&gt; 5 ENSBTAG0000005… rnaseq  joint component… -0.227      0.847 NKLS02000… 1.31e-22</span></span>
<span><span class="co">#&gt; 6 ENSBTAG0000002… rnaseq  joint component… -0.216      0.805 26         1.79e-33</span></span>
<span><span class="co">#&gt; # ℹ 24 more variables: fdr &lt;dbl&gt;, start &lt;int&gt;, end &lt;int&gt;, width &lt;int&gt;,</span></span>
<span><span class="co">#&gt; #   strand &lt;fct&gt;, Name &lt;chr&gt;, description &lt;chr&gt;, log_fc &lt;dbl&gt;, log_cpm &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   f &lt;dbl&gt;, de_signif &lt;chr&gt;, de_status &lt;chr&gt;, hmdb_id &lt;chr&gt;, name &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   chemical_formula &lt;chr&gt;, monisotopic_molecular_weight &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   cas_registry_number &lt;chr&gt;, smiles &lt;chr&gt;, inchikey &lt;chr&gt;, kegg_id &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   direct_parent &lt;chr&gt;, super_class &lt;chr&gt;, t_value &lt;dbl&gt;, padj &lt;dbl&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="cell">
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_top_features.html">get_top_features</a></span><span class="op">(</span><span class="va">mofa_output</span>, n_features <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   feature_id             dataset latent_dimension   weight importance</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                  &lt;fct&gt;   &lt;fct&gt;               &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 BovineHD0100032240     snps    Factor 1         -0.00268      1    </span></span>
<span><span class="co">#&gt; 2 Hapmap55381-rs29025399 snps    Factor 1         -0.00268      1    </span></span>
<span><span class="co">#&gt; 3 BovineHD0100032254     snps    Factor 1          0.00249      0.927</span></span>
<span><span class="co">#&gt; 4 ENSBTAG00000049569     rnaseq  Factor 1          1.89         1    </span></span>
<span><span class="co">#&gt; 5 ENSBTAG00000048835     rnaseq  Factor 1          1.88         0.999</span></span>
<span><span class="co">#&gt; 6 ENSBTAG00000039037     rnaseq  Factor 1          1.81         0.961</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_top_features.html">get_top_features</a></span><span class="op">(</span></span>
<span>  <span class="va">mofa_output</span>,</span>
<span>  min_importance <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  mo_data <span class="op">=</span> <span class="va">mo_set_complete</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 40</span></span>
<span><span class="co">#&gt;   feature_id    dataset latent_dimension   weight importance chromosome position</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;         &lt;fct&gt;   &lt;fct&gt;               &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 BovineHD0100… snps    Factor 1         -0.00268      1     1            1.13e8</span></span>
<span><span class="co">#&gt; 2 Hapmap55381-… snps    Factor 1         -0.00268      1     1            1.13e8</span></span>
<span><span class="co">#&gt; 3 BovineHD0100… snps    Factor 1          0.00249      0.927 1            1.13e8</span></span>
<span><span class="co">#&gt; 4 BovineHD2700… snps    Factor 1         -0.00225      0.839 27           3.57e7</span></span>
<span><span class="co">#&gt; 5 ENSBTAG00000… rnaseq  Factor 1          1.89         1     NKLS02001…  NA     </span></span>
<span><span class="co">#&gt; 6 ENSBTAG00000… rnaseq  Factor 1          1.88         0.999 24          NA     </span></span>
<span><span class="co">#&gt; # ℹ 33 more variables: gen_train_score &lt;dbl&gt;, ref &lt;chr&gt;, alt &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   ilmn_strand &lt;chr&gt;, customer_strand &lt;chr&gt;, norm_id &lt;dbl&gt;, qtl_type &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   qtl_effect &lt;dbl&gt;, p_value &lt;dbl&gt;, fdr &lt;dbl&gt;, start &lt;int&gt;, end &lt;int&gt;,</span></span>
<span><span class="co">#&gt; #   width &lt;int&gt;, strand &lt;fct&gt;, Name &lt;chr&gt;, description &lt;chr&gt;, log_fc &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   log_cpm &lt;dbl&gt;, f &lt;dbl&gt;, de_signif &lt;chr&gt;, de_status &lt;chr&gt;, hmdb_id &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   name &lt;chr&gt;, chemical_formula &lt;chr&gt;, monisotopic_molecular_weight &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   cas_registry_number &lt;chr&gt;, smiles &lt;chr&gt;, inchikey &lt;chr&gt;, kegg_id &lt;chr&gt;, …</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-13-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-4-tab">
<div class="cell">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_top_features.html">get_top_features</a></span><span class="op">(</span><span class="va">diablo_output</span>, n_features <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   feature_id         dataset latent_dimension weight importance</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;              &lt;fct&gt;   &lt;fct&gt;             &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 ARS-BFGL-NGS-27468 snps    Component 1      -0.632      1    </span></span>
<span><span class="co">#&gt; 2 BovineHD2300010006 snps    Component 1       0.509      0.807</span></span>
<span><span class="co">#&gt; 3 BovineHD0300000351 snps    Component 1       0.337      0.534</span></span>
<span><span class="co">#&gt; 4 ENSBTAG00000022715 rnaseq  Component 1       0.465      1    </span></span>
<span><span class="co">#&gt; 5 ENSBTAG00000050618 rnaseq  Component 1       0.378      0.813</span></span>
<span><span class="co">#&gt; 6 ENSBTAG00000049888 rnaseq  Component 1       0.305      0.655</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_top_features.html">get_top_features</a></span><span class="op">(</span></span>
<span>  <span class="va">diablo_output</span>,</span>
<span>  min_importance <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  mo_data <span class="op">=</span> <span class="va">mo_set_complete</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 40</span></span>
<span><span class="co">#&gt;   feature_id      dataset latent_dimension weight importance chromosome position</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;           &lt;fct&gt;   &lt;fct&gt;             &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 ARS-BFGL-NGS-2… snps    Component 1      -0.632      1     1            1.34e8</span></span>
<span><span class="co">#&gt; 2 BovineHD230001… snps    Component 1       0.509      0.807 23           3.43e7</span></span>
<span><span class="co">#&gt; 3 ENSBTAG0000002… rnaseq  Component 1       0.465      1     26          NA     </span></span>
<span><span class="co">#&gt; 4 ENSBTAG0000005… rnaseq  Component 1       0.378      0.813 26          NA     </span></span>
<span><span class="co">#&gt; 5 HMDB00094       metabo… Component 1      -0.716      1     &lt;NA&gt;        NA     </span></span>
<span><span class="co">#&gt; 6 BovineHD070000… snps    Component 2      -0.543      1     7            2.11e5</span></span>
<span><span class="co">#&gt; # ℹ 33 more variables: gen_train_score &lt;dbl&gt;, ref &lt;chr&gt;, alt &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   ilmn_strand &lt;chr&gt;, customer_strand &lt;chr&gt;, norm_id &lt;dbl&gt;, qtl_type &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   qtl_effect &lt;dbl&gt;, p_value &lt;dbl&gt;, fdr &lt;dbl&gt;, start &lt;int&gt;, end &lt;int&gt;,</span></span>
<span><span class="co">#&gt; #   width &lt;int&gt;, strand &lt;fct&gt;, Name &lt;chr&gt;, description &lt;chr&gt;, log_fc &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   log_cpm &lt;dbl&gt;, f &lt;dbl&gt;, de_signif &lt;chr&gt;, de_status &lt;chr&gt;, hmdb_id &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   name &lt;chr&gt;, chemical_formula &lt;chr&gt;, monisotopic_molecular_weight &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   cas_registry_number &lt;chr&gt;, smiles &lt;chr&gt;, inchikey &lt;chr&gt;, kegg_id &lt;chr&gt;, …</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="sec-interpretation-features-selected" class="level3" data-number="12.5.5"><h3 data-number="12.5.5" class="anchored" data-anchor-id="sec-interpretation-features-selected">
<span class="header-section-number">12.5.5</span> Extracting the selected features</h3>
<p>For methods that perform feature selection (i.e.&nbsp;sPLS, sO2PLS and DIABLO), we can extract information about the selected features with the <code><a href="https://rdrr.io/pkg/moiraine/man/get_selected_features.html">get_selected_features()</a></code> function. As with <code><a href="https://rdrr.io/pkg/moiraine/man/get_top_features.html">get_top_features()</a></code>, if a <code>MultiDataSet</code> object is passed to the function, it will extract information about the features from the features metadata tables and return them. If applied to the results of a method that does not perform feature selection, all features will be returned.</p>
<div class="panel-tabset" data-group="method">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">sPLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">sO2PLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false">MOFA</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-4" role="tab" aria-controls="tabset-14-4" aria-selected="false">DIABLO</a></li>
</ul>
<div class="tab-content" data-group="method">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">selected_features</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_selected_features.html">get_selected_features</a></span><span class="op">(</span><span class="va">spls_output</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">selected_features</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 120   5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">selected_features</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   feature_id         dataset latent_dimension weight importance</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;              &lt;fct&gt;   &lt;fct&gt;             &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 ENSBTAG00000022715 rnaseq  Component 1      -0.318      1    </span></span>
<span><span class="co">#&gt; 2 ENSBTAG00000050618 rnaseq  Component 1      -0.302      0.950</span></span>
<span><span class="co">#&gt; 3 ENSBTAG00000018223 rnaseq  Component 1      -0.291      0.916</span></span>
<span><span class="co">#&gt; 4 ENSBTAG00000049888 rnaseq  Component 1      -0.266      0.837</span></span>
<span><span class="co">#&gt; 5 ENSBTAG00000031647 rnaseq  Component 1      -0.264      0.831</span></span>
<span><span class="co">#&gt; 6 ENSBTAG00000046158 rnaseq  Component 1      -0.248      0.781</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">selected_features</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_selected_features.html">get_selected_features</a></span><span class="op">(</span><span class="va">so2pls_output</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">selected_features</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1394    5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">selected_features</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   feature_id         dataset latent_dimension  weight importance</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;              &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 ENSBTAG00000048835 rnaseq  joint component 1 -0.268      1    </span></span>
<span><span class="co">#&gt; 2 ENSBTAG00000049569 rnaseq  joint component 1 -0.266      0.993</span></span>
<span><span class="co">#&gt; 3 ENSBTAG00000039037 rnaseq  joint component 1 -0.248      0.925</span></span>
<span><span class="co">#&gt; 4 ENSBTAG00000031647 rnaseq  joint component 1 -0.235      0.876</span></span>
<span><span class="co">#&gt; 5 ENSBTAG00000052012 rnaseq  joint component 1 -0.227      0.847</span></span>
<span><span class="co">#&gt; 6 ENSBTAG00000022715 rnaseq  joint component 1 -0.216      0.805</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-14-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">
<div class="cell">
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">selected_features</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_selected_features.html">get_selected_features</a></span><span class="op">(</span><span class="va">mofa_output</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">selected_features</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 30735     5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">selected_features</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   feature_id             dataset latent_dimension   weight importance</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                  &lt;fct&gt;   &lt;fct&gt;               &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 BovineHD0100032240     snps    Factor 1         -0.00268      1    </span></span>
<span><span class="co">#&gt; 2 Hapmap55381-rs29025399 snps    Factor 1         -0.00268      1    </span></span>
<span><span class="co">#&gt; 3 BovineHD0100032254     snps    Factor 1          0.00249      0.927</span></span>
<span><span class="co">#&gt; 4 BovineHD2700010051     snps    Factor 1         -0.00225      0.839</span></span>
<span><span class="co">#&gt; 5 Hapmap44084-BTA-48504  snps    Factor 1         -0.00194      0.724</span></span>
<span><span class="co">#&gt; 6 BovineHD2100007115     snps    Factor 1          0.00190      0.709</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-14-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-4-tab">
<div class="cell">
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">selected_features</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_selected_features.html">get_selected_features</a></span><span class="op">(</span><span class="va">diablo_output</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">selected_features</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 200   5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">selected_features</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   feature_id         dataset latent_dimension weight importance</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;              &lt;fct&gt;   &lt;fct&gt;             &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 ARS-BFGL-NGS-27468 snps    Component 1      -0.632      1    </span></span>
<span><span class="co">#&gt; 2 BovineHD2300010006 snps    Component 1       0.509      0.807</span></span>
<span><span class="co">#&gt; 3 BovineHD0300000351 snps    Component 1       0.337      0.534</span></span>
<span><span class="co">#&gt; 4 BovineHD1900011146 snps    Component 1      -0.210      0.333</span></span>
<span><span class="co">#&gt; 5 BovineHD0900026231 snps    Component 1      -0.191      0.302</span></span>
<span><span class="co">#&gt; 6 BovineHD1100030384 snps    Component 1      -0.181      0.286</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="sec-interpretation-features-meas" class="level3" data-number="12.5.6"><h3 data-number="12.5.6" class="anchored" data-anchor-id="sec-interpretation-features-meas">
<span class="header-section-number">12.5.6</span> Features measurements</h3>
<p>Finally, we can investigate further some features of interest using the functions shown in <a href="inspecting_multidataset.html#sec-inspecting-plot-data"><span>Section&nbsp;4.5</span></a>. For the example, we will extract the top 3 contributing features from each dataset for the first latent dimension generated with the methods:</p>
<div class="panel-tabset" data-group="method">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">sPLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">sO2PLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false">MOFA</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-4" role="tab" aria-controls="tabset-15-4" aria-selected="false">DIABLO</a></li>
</ul>
<div class="tab-content" data-group="method">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell">
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">spls_top_features</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_top_features.html">get_top_features</a></span><span class="op">(</span></span>
<span>  <span class="va">spls_output</span>,</span>
<span>  n_features <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  latent_dimensions <span class="op">=</span> <span class="st">"Component 1"</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">feature_id</span><span class="op">)</span></span>
<span></span>
<span><span class="va">spls_top_features</span></span>
<span><span class="co">#&gt; [1] "ENSBTAG00000022715" "ENSBTAG00000050618" "ENSBTAG00000018223"</span></span>
<span><span class="co">#&gt; [4] "HMDB00094"          "HMDB00169"          "HMDB00159"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell">
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">so2pls_top_features</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_top_features.html">get_top_features</a></span><span class="op">(</span></span>
<span>  <span class="va">so2pls_output</span>,</span>
<span>  n_features <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  latent_dimensions <span class="op">=</span> <span class="st">"joint component 1"</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">feature_id</span><span class="op">)</span></span>
<span></span>
<span><span class="va">so2pls_top_features</span></span>
<span><span class="co">#&gt; [1] "ENSBTAG00000048835" "ENSBTAG00000049569" "ENSBTAG00000039037"</span></span>
<span><span class="co">#&gt; [4] "HMDB00094"          "HMDB00042"          "HMDB00357"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<div class="cell">
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mofa_top_features</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_top_features.html">get_top_features</a></span><span class="op">(</span></span>
<span>  <span class="va">mofa_output</span>,</span>
<span>  n_features <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  latent_dimensions <span class="op">=</span> <span class="st">"Factor 1"</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">feature_id</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mofa_top_features</span></span>
<span><span class="co">#&gt; [1] "BovineHD0100032240"     "Hapmap55381-rs29025399" "BovineHD0100032254"    </span></span>
<span><span class="co">#&gt; [4] "ENSBTAG00000049569"     "ENSBTAG00000048835"     "ENSBTAG00000039037"    </span></span>
<span><span class="co">#&gt; [7] "HMDB00094"              "HMDB00042"              "HMDB00357"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-15-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-4-tab">
<div class="cell">
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">diablo_top_features</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_top_features.html">get_top_features</a></span><span class="op">(</span></span>
<span>  <span class="va">diablo_output</span>,</span>
<span>  n_features <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  latent_dimensions <span class="op">=</span> <span class="st">"Component 1"</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">feature_id</span><span class="op">)</span></span>
<span></span>
<span><span class="va">diablo_top_features</span></span>
<span><span class="co">#&gt; [1] "ARS-BFGL-NGS-27468" "BovineHD2300010006" "BovineHD0300000351"</span></span>
<span><span class="co">#&gt; [4] "ENSBTAG00000022715" "ENSBTAG00000050618" "ENSBTAG00000049888"</span></span>
<span><span class="co">#&gt; [7] "HMDB00094"          "HMDB00042"          "HMDB00169"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>We can use the <code><a href="https://rdrr.io/pkg/moiraine/man/plot_data_heatmap.html">plot_data_heatmap()</a></code> function to visualise the measurements for the features across the samples as a heatmap. By passing a <code>MultiDataSet</code> object to the function, we can add information about the samples and the features around the heatmap, and change the label used for the features.</p>
<div class="panel-tabset" data-group="method">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true">sPLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false">sO2PLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-3" role="tab" aria-controls="tabset-16-3" aria-selected="false">MOFA</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-4" role="tab" aria-controls="tabset-16-4" aria-selected="false">DIABLO</a></li>
</ul>
<div class="tab-content" data-group="method">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="cell">
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_data_heatmap.html">plot_data_heatmap</a></span><span class="op">(</span></span>
<span>  <span class="va">mo_set_complete</span>,</span>
<span>  <span class="va">spls_top_features</span>,</span>
<span>  center <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_column_names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  only_common_samples <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  samples_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"status"</span>, <span class="st">"day_on_feed"</span><span class="op">)</span>,</span>
<span>  features_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"de_status"</span><span class="op">)</span>,</span>
<span>  colours_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"status"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Control"</span> <span class="op">=</span> <span class="st">"gold"</span>, <span class="st">"BRD"</span> <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span>,</span>
<span>    <span class="st">"day_on_feed"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html">colorRamp2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">70</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"pink3"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="st">"de_status"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"downregulated"</span> <span class="op">=</span> <span class="st">"deepskyblue"</span>, </span>
<span>                    <span class="st">"upregulated"</span> <span class="op">=</span> <span class="st">"chartreuse3"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  label_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"rnaseq"</span> <span class="op">=</span> <span class="st">"Name"</span>,</span>
<span>    <span class="st">"metabolome"</span> <span class="op">=</span> <span class="st">"name"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  truncate <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/spls-plot-top-features-heatmap-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="cell">
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_data_heatmap.html">plot_data_heatmap</a></span><span class="op">(</span></span>
<span>  <span class="va">mo_set_complete</span>,</span>
<span>  <span class="va">so2pls_top_features</span>,</span>
<span>  center <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_column_names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  only_common_samples <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  samples_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"status"</span>, <span class="st">"day_on_feed"</span><span class="op">)</span>,</span>
<span>  features_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"de_status"</span><span class="op">)</span>,</span>
<span>  colours_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"status"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Control"</span> <span class="op">=</span> <span class="st">"gold"</span>, <span class="st">"BRD"</span> <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span>,</span>
<span>    <span class="st">"day_on_feed"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html">colorRamp2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">70</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"pink3"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="st">"de_status"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"downregulated"</span> <span class="op">=</span> <span class="st">"deepskyblue"</span>, </span>
<span>                    <span class="st">"upregulated"</span> <span class="op">=</span> <span class="st">"chartreuse3"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  label_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"rnaseq"</span> <span class="op">=</span> <span class="st">"Name"</span>,</span>
<span>    <span class="st">"metabolome"</span> <span class="op">=</span> <span class="st">"name"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  truncate <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/so2pls-plot-top-features-heatmap-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</div>
<div id="tabset-16-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-3-tab">
<div class="cell">
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_data_heatmap.html">plot_data_heatmap</a></span><span class="op">(</span></span>
<span>  <span class="va">mo_set_complete</span>,</span>
<span>  <span class="va">mofa_top_features</span>,</span>
<span>  center <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_column_names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  only_common_samples <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  samples_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"status"</span>, <span class="st">"day_on_feed"</span><span class="op">)</span>,</span>
<span>  features_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"de_status"</span><span class="op">)</span>,</span>
<span>  colours_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"status"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Control"</span> <span class="op">=</span> <span class="st">"gold"</span>, <span class="st">"BRD"</span> <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span>,</span>
<span>    <span class="st">"day_on_feed"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html">colorRamp2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">70</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"pink3"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="st">"de_status"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"downregulated"</span> <span class="op">=</span> <span class="st">"deepskyblue"</span>, </span>
<span>                    <span class="st">"upregulated"</span> <span class="op">=</span> <span class="st">"chartreuse3"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  label_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"rnaseq"</span> <span class="op">=</span> <span class="st">"Name"</span>,</span>
<span>    <span class="st">"metabolome"</span> <span class="op">=</span> <span class="st">"name"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  truncate <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/mofa-plot-top-features-heatmap-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</div>
<div id="tabset-16-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-4-tab">
<div class="cell">
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_data_heatmap.html">plot_data_heatmap</a></span><span class="op">(</span></span>
<span>  <span class="va">mo_set_complete</span>,</span>
<span>  <span class="va">diablo_top_features</span>,</span>
<span>  center <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_column_names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  only_common_samples <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  samples_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"status"</span>, <span class="st">"day_on_feed"</span><span class="op">)</span>,</span>
<span>  features_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"de_status"</span><span class="op">)</span>,</span>
<span>  colours_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"status"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Control"</span> <span class="op">=</span> <span class="st">"gold"</span>, <span class="st">"BRD"</span> <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span>,</span>
<span>    <span class="st">"day_on_feed"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html">colorRamp2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">70</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"pink3"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="st">"de_status"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"downregulated"</span> <span class="op">=</span> <span class="st">"deepskyblue"</span>, </span>
<span>                    <span class="st">"upregulated"</span> <span class="op">=</span> <span class="st">"chartreuse3"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  label_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"rnaseq"</span> <span class="op">=</span> <span class="st">"Name"</span>,</span>
<span>    <span class="st">"metabolome"</span> <span class="op">=</span> <span class="st">"name"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  truncate <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/diablo-plot-top-features-heatmap-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</div>
</div>
</div>
<p>Alternatively, we can display the features’ measurements against some samples covariate, with the <code><a href="https://rdrr.io/pkg/moiraine/man/plot_data_covariate.html">plot_data_covariate()</a></code> function:</p>
<div class="panel-tabset" data-group="method">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true">sPLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false">sO2PLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-3" role="tab" aria-controls="tabset-17-3" aria-selected="false">MOFA</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-4" role="tab" aria-controls="tabset-17-4" aria-selected="false">DIABLO</a></li>
</ul>
<div class="tab-content" data-group="method">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="cell">
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_data_covariate.html">plot_data_covariate</a></span><span class="op">(</span></span>
<span>  <span class="va">mo_set_complete</span>,</span>
<span>  <span class="st">"status"</span>,</span>
<span>  <span class="va">spls_top_features</span>,</span>
<span>  only_common_samples <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  label_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"rnaseq"</span> <span class="op">=</span> <span class="st">"Name"</span>, </span>
<span>    <span class="st">"metabolome"</span> <span class="op">=</span> <span class="st">"name"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/spls-plot-top-features-covariate-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div class="cell">
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_data_covariate.html">plot_data_covariate</a></span><span class="op">(</span></span>
<span>  <span class="va">mo_set_complete</span>,</span>
<span>  <span class="st">"status"</span>,</span>
<span>  <span class="va">so2pls_top_features</span>,</span>
<span>  only_common_samples <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  label_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"rnaseq"</span> <span class="op">=</span> <span class="st">"Name"</span>, </span>
<span>    <span class="st">"metabolome"</span> <span class="op">=</span> <span class="st">"name"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/so2pls-plot-top-features-covariate-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
<div id="tabset-17-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-3-tab">
<div class="cell">
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_data_covariate.html">plot_data_covariate</a></span><span class="op">(</span></span>
<span>  <span class="va">mo_set_complete</span>,</span>
<span>  <span class="st">"status"</span>,</span>
<span>  <span class="va">mofa_top_features</span>,</span>
<span>  only_common_samples <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  label_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"rnaseq"</span> <span class="op">=</span> <span class="st">"Name"</span>, </span>
<span>    <span class="st">"metabolome"</span> <span class="op">=</span> <span class="st">"name"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/mofa-plot-top-features-covariate-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
<div id="tabset-17-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-4-tab">
<div class="cell">
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_data_covariate.html">plot_data_covariate</a></span><span class="op">(</span></span>
<span>  <span class="va">mo_set_complete</span>,</span>
<span>  <span class="st">"status"</span>,</span>
<span>  <span class="va">diablo_top_features</span>,</span>
<span>  only_common_samples <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  label_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"rnaseq"</span> <span class="op">=</span> <span class="st">"Name"</span>, </span>
<span>    <span class="st">"metabolome"</span> <span class="op">=</span> <span class="st">"name"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="interpretation_files/figure-html/diablo-plot-top-features-covariate-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="recap-targets-list" class="level2" data-number="12.6"><h2 data-number="12.6" class="anchored" data-anchor-id="recap-targets-list">
<span class="header-section-number">12.6</span> Recap – targets list</h2>
<p>For convenience, here is the list of targets that we created in this section:</p>
<details><summary>
Targets list for results interpretation
</summary><p>In the targets script, before the targets list, we will add the following code to create the colour palettes used in some of the plots:</p>
<div class="targets-chunk">
<div class="cell">
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## In the preamble of the _targets.R script</span></span>
<span></span>
<span><span class="co">## Choosing colour palettes for the samples covariates</span></span>
<span><span class="va">palette_status</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_colour_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span></span>
<span><span class="va">palette_feedlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_colour_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set2"</span><span class="op">)</span></span>
<span><span class="va">palette_geno_comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_colour_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span></span>
<span><span class="va">palette_rnaseq_batch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_colour_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Paired"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="panel-tabset" data-group="method">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true">sPLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false">sO2PLS</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-3" role="tab" aria-controls="tabset-18-3" aria-selected="false">MOFA</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-4" role="tab" aria-controls="tabset-18-4" aria-selected="false">DIABLO</a></li>
</ul>
<div class="tab-content" data-group="method">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<div class="targets-chunk">
<div class="cell">
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  <span class="co">## Generating standardised output</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">spls_output</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_output.html">get_output</a></span><span class="op">(</span><span class="va">spls_final_run</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Percentage of variance explained</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">spls_plot_variance_explained</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_variance_explained.html">plot_variance_explained</a></span><span class="op">(</span><span class="va">spls_output</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Samples score matrix plot</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">spls_samples_scores_plot</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_samples_score.html">plot_samples_score</a></span><span class="op">(</span></span>
<span>      <span class="va">spls_output</span>,</span>
<span>      mo_data <span class="op">=</span> <span class="va">mo_set_complete</span>,</span>
<span>      colour_upper <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>      scale_colour_upper <span class="op">=</span> <span class="va">palette_status</span>,</span>
<span>      shape_upper <span class="op">=</span> <span class="st">"gender"</span>,</span>
<span>      colour_lower <span class="op">=</span> <span class="st">"feedlot"</span>,</span>
<span>      scale_colour_lower <span class="op">=</span> <span class="va">palette_feedlot</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.box <span class="op">=</span> <span class="st">"vertical"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Distribution of features weight</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">spls_features_weight_distribution</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_features_weight_distr.html">plot_features_weight_distr</a></span><span class="op">(</span><span class="va">spls_output</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Plot of top contributing features</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">spls_top_features_plot</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_top_features.html">plot_top_features</a></span><span class="op">(</span></span>
<span>      <span class="va">spls_output</span>,</span>
<span>      mo_data <span class="op">=</span> <span class="va">mo_set_complete</span>,</span>
<span>      label_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>        <span class="st">"rnaseq"</span> <span class="op">=</span> <span class="st">"Name"</span>,</span>
<span>        <span class="st">"metabolome"</span> <span class="op">=</span> <span class="st">"name"</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Table of selected features</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">spls_selected_features</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_selected_features.html">get_selected_features</a></span><span class="op">(</span><span class="va">spls_output</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div class="targets-chunk">
<div class="cell">
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  <span class="co">## Generating standardised output</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">so2pls_output</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_output.html">get_output</a></span><span class="op">(</span><span class="va">so2pls_final_run</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Percentage of variance explained</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">so2pls_plot_variance_explained</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_variance_explained.html">plot_variance_explained</a></span><span class="op">(</span><span class="va">so2pls_output</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span>, angle <span class="op">=</span> <span class="fl">30</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Samples score matrix plot</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">so2pls_samples_scores_plot</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_samples_score.html">plot_samples_score</a></span><span class="op">(</span></span>
<span>      <span class="va">so2pls_output</span>,</span>
<span>      latent_dimensions <span class="op">=</span> <span class="st">"joint component 1"</span>,</span>
<span>      mo_data <span class="op">=</span> <span class="va">mo_set_complete</span>,</span>
<span>      colour_upper <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>      scale_colour_upper <span class="op">=</span> <span class="va">palette_status</span>,</span>
<span>      shape_upper <span class="op">=</span> <span class="st">"gender"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Distribution of features weight</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">so2pls_features_weight_distribution</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_features_weight_distr.html">plot_features_weight_distr</a></span><span class="op">(</span><span class="va">so2pls_output</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Plot of top contributing features</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">so2pls_top_features_plot</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_top_features.html">plot_top_features</a></span><span class="op">(</span></span>
<span>      <span class="va">so2pls_output</span>,</span>
<span>      mo_data <span class="op">=</span> <span class="va">mo_set_complete</span>,</span>
<span>      label_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>        <span class="st">"rnaseq"</span> <span class="op">=</span> <span class="st">"Name"</span>,</span>
<span>        <span class="st">"metabolome"</span> <span class="op">=</span> <span class="st">"name"</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Table of selected features</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">so2pls_selected_features</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_selected_features.html">get_selected_features</a></span><span class="op">(</span></span>
<span>      <span class="va">so2pls_output</span>,</span>
<span>      latent_dimensions <span class="op">=</span> <span class="st">"joint component 1"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div id="tabset-18-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-3-tab">
<div class="targets-chunk">
<div class="cell">
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  <span class="co">## Generating standardised output</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">mofa_output</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_output.html">get_output</a></span><span class="op">(</span><span class="va">mofa_trained</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Percentage of variance explained</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">mofa_plot_variance_explained</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_variance_explained.html">plot_variance_explained</a></span><span class="op">(</span><span class="va">mofa_output</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span>, angle <span class="op">=</span> <span class="fl">30</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Samples score matrix plot</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">mofa_samples_scores_plot</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_samples_score.html">plot_samples_score</a></span><span class="op">(</span></span>
<span>      <span class="va">mofa_output</span>,</span>
<span>      latent_dimensions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Factor"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>      mo_data <span class="op">=</span> <span class="va">mo_set_complete</span>,</span>
<span>      colour_upper <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>      scale_colour_upper <span class="op">=</span> <span class="va">palette_status</span>,</span>
<span>      shape_upper <span class="op">=</span> <span class="st">"gender"</span>,</span>
<span>      colour_lower <span class="op">=</span> <span class="st">"geno_comp_cluster"</span>,</span>
<span>      scale_colour_lower <span class="op">=</span> <span class="va">palette_geno_comp</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.box <span class="op">=</span> <span class="st">"vertical"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Distribution of features weight</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">mofa_features_weight_distribution</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_features_weight_distr.html">plot_features_weight_distr</a></span><span class="op">(</span></span>
<span>      <span class="va">mofa_output</span>,</span>
<span>      latent_dimensions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Factor"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Plot of top contributing features</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">mofa_top_features_plot</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_top_features.html">plot_top_features</a></span><span class="op">(</span></span>
<span>      <span class="va">mofa_output</span>,</span>
<span>      mo_data <span class="op">=</span> <span class="va">mo_set_complete</span>,</span>
<span>      label_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>        <span class="st">"rnaseq"</span> <span class="op">=</span> <span class="st">"Name"</span>,</span>
<span>        <span class="st">"metabolome"</span> <span class="op">=</span> <span class="st">"name"</span></span>
<span>      <span class="op">)</span>,</span>
<span>      latent_dimensions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Factor"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Table of top contributing features</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">mofa_top_features</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_top_features.html">get_top_features</a></span><span class="op">(</span></span>
<span>      <span class="va">mofa_output</span>,</span>
<span>      min_importance <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>      mo_data <span class="op">=</span> <span class="va">mo_set_complete</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div id="tabset-18-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-4-tab">
<div class="targets-chunk">
<div class="cell">
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  <span class="co">## Generating standardised output</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">diablo_output</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_output.html">get_output</a></span><span class="op">(</span><span class="va">diablo_final_run</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Percentage of variance explained</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">diablo_plot_variance_explained</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_variance_explained.html">plot_variance_explained</a></span><span class="op">(</span><span class="va">diablo_output</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Samples score matrix plot</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">diablo_samples_scores_plot</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_samples_score.html">plot_samples_score</a></span><span class="op">(</span></span>
<span>      <span class="va">diablo_output</span>,</span>
<span>      mo_data <span class="op">=</span> <span class="va">mo_set_complete</span>,</span>
<span>      colour_upper <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>      scale_colour_upper <span class="op">=</span> <span class="va">palette_status</span>,</span>
<span>      shape_upper <span class="op">=</span> <span class="st">"gender"</span>,</span>
<span>      colour_lower <span class="op">=</span> <span class="st">"rnaseq_batch"</span>,</span>
<span>      scale_colour_lower <span class="op">=</span> <span class="va">palette_rnaseq_batch</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.box <span class="op">=</span> <span class="st">"vertical"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Distribution of features weight</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">diablo_features_weight_distribution</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_features_weight_distr.html">plot_features_weight_distr</a></span><span class="op">(</span></span>
<span>      <span class="va">diablo_output</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Plot of top contributing features</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">diablo_top_features_plot</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/plot_top_features.html">plot_top_features</a></span><span class="op">(</span></span>
<span>      <span class="va">diablo_output</span>,</span>
<span>      mo_data <span class="op">=</span> <span class="va">mo_set_complete</span>,</span>
<span>      label_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>        <span class="st">"rnaseq"</span> <span class="op">=</span> <span class="st">"Name"</span>,</span>
<span>        <span class="st">"metabolome"</span> <span class="op">=</span> <span class="st">"name"</span></span>
<span>      <span class="op">)</span>,</span>
<span>      latent_dimensions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Component"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co">## Table of top contributing features</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html">tar_target</a></span><span class="op">(</span></span>
<span>    <span class="va">diablo_selected_features</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/moiraine/man/get_selected_features.html">get_selected_features</a></span><span class="op">(</span><span class="va">diablo_output</span><span class="op">)</span> </span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</details>

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./diablo.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Integration with DIABLO</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./evaluation.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Evaluating the integration results</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>